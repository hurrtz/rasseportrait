import{av as x,aw as T,ax as D,ay as k,az as b,aA as m,aB as nt,aC as z,aD as dn,aE as We,aF as fn}from"./ErrorBoundary-B8gwWKvg.js";import{U as Tt,S as de,g as G,r as W,a as vn,c as hn,R as hr,b as it,A as lt,B as dt,F as pn,L as gn,d as wt,C as mn,s as yn,e as bn,f as F,h as q,i as V}from"./fetch-b9zgsoIq.js";import"./chunk-D4RADZKF-D-8cgIpF.js";import"./Text-DYM89Pgb.js";import"./index--HF0HnC0.js";var fe;(function(e){e.SET="$set",e.SET_ONCE="$setOnce",e.ADD="$add",e.APPEND="$append",e.PREPEND="$prepend",e.REMOVE="$remove",e.PREINSERT="$preInsert",e.POSTINSERT="$postInsert",e.UNSET="$unset",e.CLEAR_ALL="$clearAll"})(fe||(fe={}));var se;(function(e){e.IDENTIFY="$identify",e.GROUP_IDENTIFY="$groupidentify",e.REVENUE="revenue_amount"})(se||(se={}));var En=1e3,ot=function(e){if(Object.keys(e).length>En)return!1;for(var t in e){var r=e[t];if(!pr(t,r))return!1}return!0},pr=function(e,t){var r,n;if(typeof e!="string")return!1;if(Array.isArray(t)){var i=!0;try{for(var o=x(t),a=o.next();!a.done;a=o.next()){var s=a.value;if(Array.isArray(s))return!1;if(typeof s=="object")i=i&&ot(s);else if(!["number","string"].includes(typeof s))return!1;if(!i)return!1}}catch(u){r={error:u}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}else{if(t==null)return!1;if(typeof t=="object")return ot(t);if(!["number","string","boolean"].includes(typeof t))return!1}return!0},Re=function(){function e(){this._propertySet=new Set,this._properties={}}return e.prototype.getUserProperties=function(){return T({},this._properties)},e.prototype.set=function(t,r){return this._safeSet(O.SET,t,r),this},e.prototype.setOnce=function(t,r){return this._safeSet(O.SET_ONCE,t,r),this},e.prototype.append=function(t,r){return this._safeSet(O.APPEND,t,r),this},e.prototype.prepend=function(t,r){return this._safeSet(O.PREPEND,t,r),this},e.prototype.postInsert=function(t,r){return this._safeSet(O.POSTINSERT,t,r),this},e.prototype.preInsert=function(t,r){return this._safeSet(O.PREINSERT,t,r),this},e.prototype.remove=function(t,r){return this._safeSet(O.REMOVE,t,r),this},e.prototype.add=function(t,r){return this._safeSet(O.ADD,t,r),this},e.prototype.unset=function(t){return this._safeSet(O.UNSET,t,Tt),this},e.prototype.clearAll=function(){return this._properties={},this._properties[O.CLEAR_ALL]=Tt,this},e.prototype._safeSet=function(t,r,n){if(this._validate(t,r,n)){var i=this._properties[t];return i===void 0&&(i={},this._properties[t]=i),i[r]=n,this._propertySet.add(r),!0}return!1},e.prototype._validate=function(t,r,n){return this._properties[O.CLEAR_ALL]!==void 0||this._propertySet.has(r)?!1:t===O.ADD?typeof n=="number":t!==O.UNSET&&t!==O.REMOVE?pr(r,n):!0},e}(),O;(function(e){e.SET="$set",e.SET_ONCE="$setOnce",e.ADD="$add",e.APPEND="$append",e.PREPEND="$prepend",e.REMOVE="$remove",e.PREINSERT="$preInsert",e.POSTINSERT="$postInsert",e.UNSET="$unset",e.CLEAR_ALL="$clearAll"})(O||(O={}));var _n=[O.CLEAR_ALL,O.UNSET,O.SET,O.SET_ONCE,O.ADD,O.APPEND,O.PREPEND,O.PREINSERT,O.POSTINSERT,O.REMOVE],Tn="Event tracked successfully",wn="Unexpected error occurred",Sn="Event rejected due to exceeded retry count",In="Event skipped due to optOut config",An="Event rejected due to missing API key",kn="Invalid API key",Pn="Client not initialized",he=function(e,t,r){return t===void 0&&(t=0),r===void 0&&(r=de.Unknown),{event:e,code:t,message:r}},Rn=function(e){return e?(e^Math.random()*16>>e/4).toString(16):(String(1e7)+String(-1e3)+String(-4e3)+String(-8e3)+String(-1e11)).replace(/[018]/g,ue)},St=D([],k(Array(256).keys()),!1).map(function(e){return e.toString(16).padStart(2,"0")}),ue=function(e){var t,r=G();if(!(!((t=r==null?void 0:r.crypto)===null||t===void 0)&&t.getRandomValues))return Rn(e);var n=r.crypto.getRandomValues(new Uint8Array(16));return n[6]=n[6]&15|64,n[8]=n[8]&63|128,D([],k(n.entries()),!1).map(function(i){var o=k(i,2),a=o[0],s=o[1];return[4,6,8,10].includes(a)?"-".concat(St[s]):St[s]}).join("")},Cn=function(){function e(t){this.client=t,this.queue=[],this.applying=!1,this.plugins=[]}return e.prototype.register=function(t,r){var n,i;return b(this,void 0,void 0,function(){return m(this,function(o){switch(o.label){case 0:return this.plugins.some(function(a){return a.name===t.name})?(r.loggerProvider.warn("Plugin with name ".concat(t.name," already exists, skipping registration")),[2]):(t.name===void 0&&(t.name=ue(),r.loggerProvider.warn(`Plugin name is undefined. 
      Generating a random UUID for plugin name: `.concat(t.name,`. 
      Set a name for the plugin to prevent it from being added multiple times.`))),t.type=(n=t.type)!==null&&n!==void 0?n:"enrichment",[4,(i=t.setup)===null||i===void 0?void 0:i.call(t,r,this.client)]);case 1:return o.sent(),this.plugins.push(t),[2]}})})},e.prototype.deregister=function(t,r){var n;return b(this,void 0,void 0,function(){var i,o;return m(this,function(a){switch(a.label){case 0:return i=this.plugins.findIndex(function(s){return s.name===t}),i===-1?(r.loggerProvider.warn("Plugin with name ".concat(t," does not exist, skipping deregistration")),[2]):(o=this.plugins[i],this.plugins.splice(i,1),[4,(n=o.teardown)===null||n===void 0?void 0:n.call(o)]);case 1:return a.sent(),[2]}})})},e.prototype.reset=function(t){this.applying=!1;var r=this.plugins;r.map(function(n){var i;return(i=n.teardown)===null||i===void 0?void 0:i.call(n)}),this.plugins=[],this.client=t},e.prototype.push=function(t){var r=this;return new Promise(function(n){r.queue.push([t,n]),r.scheduleApply(0)})},e.prototype.scheduleApply=function(t){var r=this;this.applying||(this.applying=!0,setTimeout(function(){r.apply(r.queue.shift()).then(function(){r.applying=!1,r.queue.length>0&&r.scheduleApply(0)})},t))},e.prototype.apply=function(t){return b(this,void 0,void 0,function(){var r,n,i,o,a,s,u,v,h,c,l,d,f,v,h,y,_,p,g,E,S,I;return m(this,function(w){switch(w.label){case 0:if(!t)return[2];r=k(t,1),n=r[0],i=k(t,2),o=i[1],a=this.plugins.filter(function(P){return P.type==="before"}),w.label=1;case 1:w.trys.push([1,6,7,8]),s=x(a),u=s.next(),w.label=2;case 2:return u.done?[3,5]:(v=u.value,v.execute?[4,v.execute(T({},n))]:[3,4]);case 3:if(h=w.sent(),h===null)return o({event:n,code:0,message:""}),[2];n=h,w.label=4;case 4:return u=s.next(),[3,2];case 5:return[3,8];case 6:return c=w.sent(),g={error:c},[3,8];case 7:try{u&&!u.done&&(E=s.return)&&E.call(s)}finally{if(g)throw g.error}return[7];case 8:l=this.plugins.filter(function(P){return P.type==="enrichment"||P.type===void 0}),w.label=9;case 9:w.trys.push([9,14,15,16]),d=x(l),f=d.next(),w.label=10;case 10:return f.done?[3,13]:(v=f.value,v.execute?[4,v.execute(T({},n))]:[3,12]);case 11:if(h=w.sent(),h===null)return o({event:n,code:0,message:""}),[2];n=h,w.label=12;case 12:return f=d.next(),[3,10];case 13:return[3,16];case 14:return y=w.sent(),S={error:y},[3,16];case 15:try{f&&!f.done&&(I=d.return)&&I.call(d)}finally{if(S)throw S.error}return[7];case 16:return _=this.plugins.filter(function(P){return P.type==="destination"}),p=_.map(function(P){var C=T({},n);return P.execute(C).catch(function(R){return he(C,0,String(R))})}),Promise.all(p).then(function(P){var C=k(P,1),R=C[0],U=R||he(n,100,"Event not tracked, no destination plugins on the instance");o(U)}),[2]}})})},e.prototype.flush=function(){return b(this,void 0,void 0,function(){var t,r,n,i=this;return m(this,function(o){switch(o.label){case 0:return t=this.queue,this.queue=[],[4,Promise.all(t.map(function(a){return i.apply(a)}))];case 1:return o.sent(),r=this.plugins.filter(function(a){return a.type==="destination"}),n=r.map(function(a){return a.flush&&a.flush()}),[4,Promise.all(n)];case 2:return o.sent(),[2]}})})},e.prototype.onIdentityChanged=function(t){this.plugins.forEach(function(r){var n;(n=r.onIdentityChanged)===null||n===void 0||n.call(r,t)})},e.prototype.onSessionIdChanged=function(t){this.plugins.forEach(function(r){var n;(n=r.onSessionIdChanged)===null||n===void 0||n.call(r,t)})},e.prototype.onOptOutChanged=function(t){this.plugins.forEach(function(r){var n;(n=r.onOptOutChanged)===null||n===void 0||n.call(r,t)})},e}(),On=function(e,t,r){var n=typeof e=="string"?{event_type:e}:e;return T(T(T({},n),r),t&&{event_properties:t})},gr=function(e,t){var r=T(T({},t),{event_type:se.IDENTIFY,user_properties:e.getUserProperties()});return r},Ln=function(e,t,r,n){var i,o=T(T({},n),{event_type:se.GROUP_IDENTIFY,group_properties:r.getUserProperties(),groups:(i={},i[e]=t,i)});return o},Nn=function(e,t,r){var n,i=new Re;i.set(e,t);var o=T(T({},r),{event_type:se.IDENTIFY,user_properties:i.getUserProperties(),groups:(n={},n[e]=t,n)});return o},xn=function(e,t){return T(T({},t),{event_type:se.REVENUE,event_properties:e.getEventProperties()})},Dn=function(){function e(t){t===void 0&&(t="$default"),this.initializing=!1,this.isReady=!1,this.q=[],this.dispatchQ=[],this.logEvent=this.track.bind(this),this.timeline=new Cn(this),this.name=t}return e.prototype._init=function(t){return b(this,void 0,void 0,function(){return m(this,function(r){switch(r.label){case 0:return this.config=t,this.timeline.reset(this),[4,this.runQueuedFunctions("q")];case 1:return r.sent(),this.isReady=!0,[2]}})})},e.prototype.runQueuedFunctions=function(t){return b(this,void 0,void 0,function(){var r,n,i,o,a,s,u,c;return m(this,function(l){switch(l.label){case 0:r=this[t],this[t]=[],l.label=1;case 1:l.trys.push([1,8,9,10]),n=x(r),i=n.next(),l.label=2;case 2:return i.done?[3,7]:(o=i.value,a=o(),a&&"promise"in a?[4,a.promise]:[3,4]);case 3:return l.sent(),[3,6];case 4:return[4,a];case 5:l.sent(),l.label=6;case 6:return i=n.next(),[3,2];case 7:return[3,10];case 8:return s=l.sent(),u={error:s},[3,10];case 9:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(u)throw u.error}return[7];case 10:return this[t].length?[4,this.runQueuedFunctions(t)]:[3,12];case 11:l.sent(),l.label=12;case 12:return[2]}})})},e.prototype.track=function(t,r,n){var i=On(t,r,n);return W(this.dispatch(i))},e.prototype.identify=function(t,r){var n=gr(t,r);return W(this.dispatch(n))},e.prototype.groupIdentify=function(t,r,n,i){var o=Ln(t,r,n,i);return W(this.dispatch(o))},e.prototype.setGroup=function(t,r,n){var i=Nn(t,r,n);return W(this.dispatch(i))},e.prototype.revenue=function(t,r){var n=xn(t,r);return W(this.dispatch(n))},e.prototype.add=function(t){return this.isReady?this._addPlugin(t):(this.q.push(this._addPlugin.bind(this,t)),W())},e.prototype._addPlugin=function(t){return W(this.timeline.register(t,this.config))},e.prototype.remove=function(t){return this.isReady?this._removePlugin(t):(this.q.push(this._removePlugin.bind(this,t)),W())},e.prototype._removePlugin=function(t){return W(this.timeline.deregister(t,this.config))},e.prototype.dispatchWithCallback=function(t,r){if(!this.isReady)return r(he(t,0,Pn));this.process(t).then(r)},e.prototype.dispatch=function(t){return b(this,void 0,void 0,function(){var r=this;return m(this,function(n){return this.isReady?[2,this.process(t)]:[2,new Promise(function(i){r.dispatchQ.push(r.dispatchWithCallback.bind(r,t,i))})]})})},e.prototype.getOperationAppliedUserProperties=function(t){var r={};if(t===void 0)return r;var n={};return Object.keys(t).forEach(function(i){Object.values(fe).includes(i)||(n[i]=t[i])}),_n.forEach(function(i){if(Object.keys(t).includes(i)){var o=t[i];switch(i){case fe.CLEAR_ALL:Object.keys(r).forEach(function(a){delete r[a]});break;case fe.UNSET:Object.keys(o).forEach(function(a){delete r[a]});break;case fe.SET:Object.assign(r,o);break}}}),Object.assign(r,n),r},e.prototype.process=function(t){return b(this,void 0,void 0,function(){var r,o,n,i,o;return m(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),this.config.optOut?[2,he(t,0,In)]:(t.event_type===se.IDENTIFY&&(r=this.getOperationAppliedUserProperties(t.user_properties),this.timeline.onIdentityChanged({userProperties:r})),[4,this.timeline.push(t)]);case 1:return o=a.sent(),o.code===200?this.config.loggerProvider.log(o.message):o.code===100?this.config.loggerProvider.warn(o.message):this.config.loggerProvider.error(o.message),[2,o];case 2:return n=a.sent(),i=String(n),this.config.loggerProvider.error(i),o=he(t,0,i),[2,o];case 3:return[2]}})})},e.prototype.setOptOut=function(t){if(!this.isReady){this.q.push(this._setOptOut.bind(this,!!t));return}this._setOptOut(t)},e.prototype._setOptOut=function(t){this.config.optOut!==t&&(this.timeline.onOptOutChanged(t),this.config.optOut=!!t)},e.prototype.flush=function(){return W(this.timeline.flush())},e.prototype.plugin=function(t){var r=this.timeline.plugins.find(function(n){return n.name===t});if(r===void 0){this.config.loggerProvider.debug("Cannot find plugin with name ".concat(t));return}return r},e.prototype.plugins=function(t){return this.timeline.plugins.filter(function(r){return r instanceof t})},e}(),Un=function(){function e(){this.productId="",this.quantity=1,this.price=0}return e.prototype.setProductId=function(t){return this.productId=t,this},e.prototype.setQuantity=function(t){return t>0&&(this.quantity=t),this},e.prototype.setPrice=function(t){return this.price=t,this},e.prototype.setRevenueType=function(t){return this.revenueType=t,this},e.prototype.setCurrency=function(t){return this.currency=t,this},e.prototype.setRevenue=function(t){return this.revenue=t,this},e.prototype.setReceipt=function(t){return this.receipt=t,this},e.prototype.setReceiptSig=function(t){return this.receiptSig=t,this},e.prototype.setEventProperties=function(t){return ot(t)&&(this.properties=t),this},e.prototype.getEventProperties=function(){var t=this.properties?T({},this.properties):{};return t[re.REVENUE_PRODUCT_ID]=this.productId,t[re.REVENUE_QUANTITY]=this.quantity,t[re.REVENUE_PRICE]=this.price,t[re.REVENUE_TYPE]=this.revenueType,t[re.REVENUE_CURRENCY]=this.currency,t[re.REVENUE]=this.revenue,t[re.RECEIPT]=this.receipt,t[re.RECEIPT_SIG]=this.receiptSig,t},e}(),re;(function(e){e.REVENUE_PRODUCT_ID="$productId",e.REVENUE_QUANTITY="$quantity",e.REVENUE_PRICE="$price",e.REVENUE_TYPE="$revenueType",e.REVENUE_CURRENCY="$currency",e.REVENUE="$revenue",e.RECEIPT="$receipt",e.RECEIPT_SIG="$receiptSig"})(re||(re={}));var Mn=function(e,t){var r=Math.max(t,1);return e.reduce(function(n,i,o){var a=Math.floor(o/r);return n[a]||(n[a]=[]),n[a].push(i),n},[])};function Fn(e){return e instanceof Error?e.message:String(e)}function Ee(e){var t="";try{"body"in e&&(t=JSON.stringify(e.body,null,2))}catch{}return t}var qn=function(){function e(){this.name="amplitude",this.type="destination",this.retryTimeout=1e3,this.throttleTimeout=3e4,this.storageKey="",this.scheduleId=null,this.scheduledTimeout=0,this.flushId=null,this.queue=[]}return e.prototype.setup=function(t){var r;return b(this,void 0,void 0,function(){var n,i=this;return m(this,function(o){switch(o.label){case 0:return this.config=t,this.storageKey="".concat(vn,"_").concat(this.config.apiKey.substring(0,10)),[4,(r=this.config.storageProvider)===null||r===void 0?void 0:r.get(this.storageKey)];case 1:return n=o.sent(),n&&n.length>0&&Promise.all(n.map(function(a){return i.execute(a)})).catch(),[2,Promise.resolve(void 0)]}})})},e.prototype.execute=function(t){var r=this;return t.insert_id||(t.insert_id=ue()),new Promise(function(n){var i={event:t,attempts:0,callback:function(o){return n(o)},timeout:0};r.queue.push(i),r.schedule(r.config.flushIntervalMillis),r.saveEvents()})},e.prototype.removeEventsExceedFlushMaxRetries=function(t){var r=this;return t.filter(function(n){return n.attempts+=1,n.attempts<r.config.flushMaxRetries?!0:(r.fulfillRequest([n],500,Sn),!1)})},e.prototype.scheduleEvents=function(t){var r=this;t.forEach(function(n){r.schedule(n.timeout===0?r.config.flushIntervalMillis:n.timeout)})},e.prototype.schedule=function(t){var r=this;if(!this.config.offline&&(this.scheduleId===null||this.scheduleId&&t>this.scheduledTimeout)){this.scheduleId&&clearTimeout(this.scheduleId),this.scheduledTimeout=t,this.scheduleId=setTimeout(function(){r.queue=r.queue.map(function(n){return n.timeout=0,n}),r.flush(!0)},t);return}},e.prototype.resetSchedule=function(){this.scheduleId=null,this.scheduledTimeout=0},e.prototype.flush=function(t){return t===void 0&&(t=!1),b(this,void 0,void 0,function(){var r,n,i,o=this;return m(this,function(a){switch(a.label){case 0:return this.config.offline?(this.resetSchedule(),this.config.loggerProvider.debug("Skipping flush while offline."),[2]):this.flushId?(this.resetSchedule(),this.config.loggerProvider.debug("Skipping flush because previous flush has not resolved."),[2]):(this.flushId=this.scheduleId,this.resetSchedule(),r=[],n=[],this.queue.forEach(function(s){return s.timeout===0?r.push(s):n.push(s)}),i=Mn(r,this.config.flushQueueSize),[4,i.reduce(function(s,u){return b(o,void 0,void 0,function(){return m(this,function(c){switch(c.label){case 0:return[4,s];case 1:return c.sent(),[4,this.send(u,t)];case 2:return[2,c.sent()]}})})},Promise.resolve())]);case 1:return a.sent(),this.flushId=null,this.scheduleEvents(this.queue),[2]}})})},e.prototype.send=function(t,r){return r===void 0&&(r=!0),b(this,void 0,void 0,function(){var n,i,o,a,s;return m(this,function(u){switch(u.label){case 0:if(!this.config.apiKey)return[2,this.fulfillRequest(t,400,An)];n={api_key:this.config.apiKey,events:t.map(function(c){var l=c.event;l.extra;var d=nt(l,["extra"]);return d}),options:{min_id_length:this.config.minIdLength},client_upload_time:new Date().toISOString(),request_metadata:this.config.requestMetadata},this.config.requestMetadata=new hr,u.label=1;case 1:return u.trys.push([1,3,,4]),i=hn(this.config.serverUrl,this.config.serverZone,this.config.useBatch).serverUrl,[4,this.config.transportProvider.send(i,n)];case 2:return o=u.sent(),o===null?(this.fulfillRequest(t,0,wn),[2]):r?(this.handleResponse(o,t),[3,4]):("body"in o?this.fulfillRequest(t,o.statusCode,"".concat(o.status,": ").concat(Ee(o))):this.fulfillRequest(t,o.statusCode,o.status),[2]);case 3:return a=u.sent(),s=Fn(a),this.config.loggerProvider.error(s),this.handleResponse({status:de.Failed,statusCode:0},t),[3,4];case 4:return[2]}})})},e.prototype.handleResponse=function(t,r){var n=t.status;switch(n){case de.Success:{this.handleSuccessResponse(t,r);break}case de.Invalid:{this.handleInvalidResponse(t,r);break}case de.PayloadTooLarge:{this.handlePayloadTooLargeResponse(t,r);break}case de.RateLimit:{this.handleRateLimitResponse(t,r);break}default:{this.config.loggerProvider.warn(`{code: 0, error: "Status '`.concat(n,"' provided for ").concat(r.length,' events"}')),this.handleOtherResponse(r);break}}},e.prototype.handleSuccessResponse=function(t,r){this.fulfillRequest(r,t.statusCode,Tn)},e.prototype.handleInvalidResponse=function(t,r){var n=this;if(t.body.missingField||t.body.error.startsWith(kn)){this.fulfillRequest(r,t.statusCode,t.body.error);return}var i=D(D(D(D([],k(Object.values(t.body.eventsWithInvalidFields)),!1),k(Object.values(t.body.eventsWithMissingFields)),!1),k(Object.values(t.body.eventsWithInvalidIdLengths)),!1),k(t.body.silencedEvents),!1).flat(),o=new Set(i),a=r.filter(function(u,c){if(o.has(c)){n.fulfillRequest([u],t.statusCode,t.body.error);return}return!0});a.length>0&&this.config.loggerProvider.warn(Ee(t));var s=this.removeEventsExceedFlushMaxRetries(a);this.scheduleEvents(s)},e.prototype.handlePayloadTooLargeResponse=function(t,r){if(r.length===1){this.fulfillRequest(r,t.statusCode,t.body.error);return}this.config.loggerProvider.warn(Ee(t)),this.config.flushQueueSize/=2;var n=this.removeEventsExceedFlushMaxRetries(r);this.scheduleEvents(n)},e.prototype.handleRateLimitResponse=function(t,r){var n=this,i=Object.keys(t.body.exceededDailyQuotaUsers),o=Object.keys(t.body.exceededDailyQuotaDevices),a=t.body.throttledEvents,s=new Set(i),u=new Set(o),c=new Set(a),l=r.filter(function(f,v){if(f.event.user_id&&s.has(f.event.user_id)||f.event.device_id&&u.has(f.event.device_id)){n.fulfillRequest([f],t.statusCode,t.body.error);return}return c.has(v)&&(f.timeout=n.throttleTimeout),!0});l.length>0&&this.config.loggerProvider.warn(Ee(t));var d=this.removeEventsExceedFlushMaxRetries(l);this.scheduleEvents(d)},e.prototype.handleOtherResponse=function(t){var r=this,n=t.map(function(o){return o.timeout=o.attempts*r.retryTimeout,o}),i=this.removeEventsExceedFlushMaxRetries(n);this.scheduleEvents(i)},e.prototype.fulfillRequest=function(t,r,n){this.removeEvents(t),t.forEach(function(i){return i.callback(he(i.event,r,n))})},e.prototype.saveEvents=function(){if(this.config.storageProvider){var t=this.queue.map(function(r){return r.event});this.config.storageProvider.set(this.storageKey,t)}},e.prototype.removeEvents=function(t){this.queue=this.queue.filter(function(r){return!t.some(function(n){return n.event.insert_id===r.event.insert_id})}),this.saveEvents()},e}(),Vn=function(){function e(){this.name="identity",this.type="before",this.identityStore=it().identityStore}return e.prototype.execute=function(t){return b(this,void 0,void 0,function(){var r;return m(this,function(n){return r=t.user_properties,r&&this.identityStore.editIdentity().updateUserProperties(r).commit(),[2,t]})})},e.prototype.setup=function(t){return b(this,void 0,void 0,function(){return m(this,function(r){return t.instanceName&&(this.identityStore=it(t.instanceName).identityStore),[2]})})},e}(),mr=function(e,t){t===void 0&&(t=Date.now());var r=Date.now(),n=r-t;return n>e},yr=function(e,t,r){return t===void 0&&(t=""),r===void 0&&(r=10),[lt,t,e.substring(0,r)].filter(Boolean).join("_")},jn=function(e){return"".concat(lt.toLowerCase(),"_").concat(e.substring(0,6))},$n=function(){var e,t,r,n;if(typeof navigator>"u")return"";var i=navigator.userLanguage;return(n=(r=(t=(e=navigator.languages)===null||e===void 0?void 0:e[0])!==null&&t!==void 0?t:navigator.language)!==null&&r!==void 0?r:i)!==null&&n!==void 0?n:""},Ce=function(){var e,t=G();if(!(!((e=t==null?void 0:t.location)===null||e===void 0)&&e.search))return{};var r=t.location.search.substring(1).split("&").filter(Boolean),n=r.reduce(function(i,o){var a=o.split("=",2),s=It(a[0]),u=It(a[1]);return u&&(i[s]=u),i},{});return n},It=function(e){e===void 0&&(e="");try{return decodeURIComponent(e)}catch{return""}},ft=function(){function e(){this.memoryStorage=new Map}return e.prototype.isEnabled=function(){return b(this,void 0,void 0,function(){return m(this,function(t){return[2,!0]})})},e.prototype.get=function(t){return b(this,void 0,void 0,function(){return m(this,function(r){return[2,this.memoryStorage.get(t)]})})},e.prototype.getRaw=function(t){return b(this,void 0,void 0,function(){var r;return m(this,function(n){switch(n.label){case 0:return[4,this.get(t)];case 1:return r=n.sent(),[2,r?JSON.stringify(r):void 0]}})})},e.prototype.set=function(t,r){return b(this,void 0,void 0,function(){return m(this,function(n){return this.memoryStorage.set(t,r),[2]})})},e.prototype.remove=function(t){return b(this,void 0,void 0,function(){return m(this,function(r){return this.memoryStorage.delete(t),[2]})})},e.prototype.reset=function(){return b(this,void 0,void 0,function(){return m(this,function(t){return this.memoryStorage.clear(),[2]})})},e}(),at=function(){function e(t){this.options=T({},t)}return e.prototype.isEnabled=function(){return b(this,void 0,void 0,function(){var t,r,n;return m(this,function(i){switch(i.label){case 0:if(!G())return[2,!1];e.testValue=String(Date.now()),t=new e(this.options),r="AMP_TEST",i.label=1;case 1:return i.trys.push([1,4,5,7]),[4,t.set(r,e.testValue)];case 2:return i.sent(),[4,t.get(r)];case 3:return n=i.sent(),[2,n===e.testValue];case 4:return i.sent(),[2,!1];case 5:return[4,t.remove(r)];case 6:return i.sent(),[7];case 7:return[2]}})})},e.prototype.get=function(t){var r;return b(this,void 0,void 0,function(){var n,i;return m(this,function(o){switch(o.label){case 0:return[4,this.getRaw(t)];case 1:if(n=o.sent(),!n)return[2,void 0];try{return i=(r=Gn(n))!==null&&r!==void 0?r:Bn(n),i===void 0?(console.error("Amplitude Logger [Error]: Failed to decode cookie value for key: ".concat(t,", value: ").concat(n)),[2,void 0]):[2,JSON.parse(i)]}catch{return console.error("Amplitude Logger [Error]: Failed to parse cookie value for key: ".concat(t,", value: ").concat(n)),[2,void 0]}return[2]}})})},e.prototype.getRaw=function(t){var r,n;return b(this,void 0,void 0,function(){var i,o,a;return m(this,function(s){return i=G(),o=(n=(r=i==null?void 0:i.document)===null||r===void 0?void 0:r.cookie.split("; "))!==null&&n!==void 0?n:[],a=o.find(function(u){return u.indexOf(t+"=")===0}),a?[2,a.substring(t.length+1)]:[2,void 0]})})},e.prototype.set=function(t,r){var n;return b(this,void 0,void 0,function(){var i,o,a,s,u,c,l;return m(this,function(d){try{i=(n=this.options.expirationDays)!==null&&n!==void 0?n:0,o=r!==null?i:-1,a=void 0,o&&(s=new Date,s.setTime(s.getTime()+o*24*60*60*1e3),a=s),u="".concat(t,"=").concat(btoa(encodeURIComponent(JSON.stringify(r)))),a&&(u+="; expires=".concat(a.toUTCString())),u+="; path=/",this.options.domain&&(u+="; domain=".concat(this.options.domain)),this.options.secure&&(u+="; Secure"),this.options.sameSite&&(u+="; SameSite=".concat(this.options.sameSite)),c=G(),c&&(c.document.cookie=u)}catch(f){l=f instanceof Error?f.message:String(f),console.error("Amplitude Logger [Error]: Failed to set cookie for key: ".concat(t,". Error: ").concat(l))}return[2]})})},e.prototype.remove=function(t){return b(this,void 0,void 0,function(){return m(this,function(r){switch(r.label){case 0:return[4,this.set(t,null)];case 1:return r.sent(),[2]}})})},e.prototype.reset=function(){return b(this,void 0,void 0,function(){return m(this,function(t){return[2]})})},e}(),Gn=function(e){try{return decodeURIComponent(atob(e))}catch{return}},Bn=function(e){try{return decodeURIComponent(atob(decodeURIComponent(e)))}catch{return}},Hn=function(e,t,r){return r===void 0&&(r=10),[lt,t,e.substring(0,r)].filter(Boolean).join("_")},Kn=null,Wn=["a","button","input","select","textarea","label","video","audio",'[contenteditable="true" i]',"[data-amp-default-track]",".amp-default-track"],zn="data-amp-track-",Yn=["div","span","h1","h2","h3","h4","h5","h6"],br=100,Xn=function(){function e(t){this.request=t}return Object.defineProperty(e.prototype,"headers",{get:function(){if(this._headers)return this._headers;var t=this.request.headers;if(Array.isArray(t)){var r=t;this._headers=r.reduce(function(o,a){var s=k(a,2),u=s[0],c=s[1];return o[u]=c,o},{})}else if(t instanceof Headers){var n=t,i={};n.forEach(function(o,a){i[a]=o}),this._headers=i}else typeof t=="object"&&(this._headers=t);return this._headers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodySize",{get:function(){if(typeof this._bodySize=="number")return this._bodySize;var t=G();if(t!=null&&t.TextEncoder){var r=this.request.body;return this._bodySize=Er(r,br),this._bodySize}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"method",{get:function(){return this.request.method},enumerable:!1,configurable:!0}),e}(),Jn=function(){function e(t){this.body=t}return Object.defineProperty(e.prototype,"bodySize",{get:function(){return Er(this.body,br)},enumerable:!1,configurable:!0}),e}();function Er(e,t){var r,n,i,o=G(),a=o==null?void 0:o.TextEncoder;if(a){var s;if(typeof e=="string")s=e,i=new a().encode(s).length;else if(e instanceof Blob)s=e,i=s.size;else if(e instanceof URLSearchParams)s=e,i=new a().encode(s.toString()).length;else if(ArrayBuffer.isView(e))s=e,i=s.byteLength;else if(e instanceof ArrayBuffer)s=e,i=s.byteLength;else if(e instanceof FormData){var u=e,c=0,l=0;try{for(var d=x(u.entries()),f=d.next();!f.done;f=d.next()){var v=k(f.value,2),h=v[0],y=v[1];if(c+=h.length,typeof y=="string")c+=new a().encode(y).length;else if(y instanceof Blob)c+=y.size;else return;if(++l>=t)return}}catch(_){r={error:_}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}i=c}else if(e instanceof ReadableStream){s=e;return}return i}}var Qn=function(){function e(t){this.response=t}return Object.defineProperty(e.prototype,"headers",{get:function(){var t;if(this._headers)return this._headers;if(this.response.headers instanceof Headers){var r=this.response.headers,n={};return(t=r==null?void 0:r.forEach)===null||t===void 0||t.call(r,function(i,o){n[o]=i}),this._headers=n,n}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bodySize",{get:function(){var t,r;if(this._bodySize!==void 0)return this._bodySize;var n=(r=(t=this.response.headers)===null||t===void 0?void 0:t.get)===null||r===void 0?void 0:r.call(t,"content-length"),i=n?parseInt(n,10):void 0;return this._bodySize=i,i},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this.response.status},enumerable:!1,configurable:!0}),e}(),Zn=function(){function e(t,r,n){this.statusCode=t,this.headersString=r,this.size=n}return Object.defineProperty(e.prototype,"bodySize",{get:function(){return this.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this.statusCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headers",{get:function(){var t,r;if(this.headersString){var n={},i=this.headersString.split(`\r
`);try{for(var o=x(i),a=o.next();!a.done;a=o.next()){var s=a.value,u=k(s.split(": "),2),c=u[0],l=u[1];c&&l&&(n[c]=l)}}catch(d){t={error:d}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return n}},enumerable:!1,configurable:!0}),e}(),ei=function(){function e(t,r,n,i,o,a,s,u,c,l,d){s===void 0&&(s=0),this.type=t,this.method=r,this.timestamp=n,this.startTime=i,this.url=o,this.requestWrapper=a,this.status=s,this.duration=u,this.responseWrapper=c,this.error=l,this.endTime=d}return e.prototype.toSerializable=function(){var t,r,n,i,o={type:this.type,method:this.method,url:this.url,timestamp:this.timestamp,status:this.status,duration:this.duration,error:this.error,startTime:this.startTime,endTime:this.endTime,requestHeaders:(t=this.requestWrapper)===null||t===void 0?void 0:t.headers,requestBodySize:(r=this.requestWrapper)===null||r===void 0?void 0:r.bodySize,responseHeaders:(n=this.responseWrapper)===null||n===void 0?void 0:n.headers,responseBodySize:(i=this.responseWrapper)===null||i===void 0?void 0:i.bodySize};return Object.fromEntries(Object.entries(o).filter(function(a){var s=k(a,2);s[0];var u=s[1];return u!==void 0}))},e}();function ti(e){return typeof e=="object"&&e!==null&&"url"in e&&"method"in e}var ri=function(){function e(t,r){r===void 0&&(r=ue()),this.callback=t,this.id=r}return e}(),ni=function(){function e(t){this.eventCallbacks=new Map,this.isObserving=!1,this.logger=t;var r=G();e.isSupported()&&(this.globalScope=r)}return e.isSupported=function(){var t=G();return!!t&&!!t.fetch},e.prototype.subscribe=function(t,r){var n,i,o,a,s,u,c;if(this.logger||(this.logger=r),this.eventCallbacks.set(t.id,t),!this.isObserving){var l=(o=(i=(n=this.globalScope)===null||n===void 0?void 0:n.XMLHttpRequest)===null||i===void 0?void 0:i.prototype)===null||o===void 0?void 0:o.open,d=(u=(s=(a=this.globalScope)===null||a===void 0?void 0:a.XMLHttpRequest)===null||s===void 0?void 0:s.prototype)===null||u===void 0?void 0:u.send;l&&d&&this.observeXhr(l,d);var f=(c=this.globalScope)===null||c===void 0?void 0:c.fetch;f&&this.observeFetch(f),this.isObserving=!0}},e.prototype.unsubscribe=function(t){this.eventCallbacks.delete(t.id)},e.prototype.triggerEventCallbacks=function(t){var r=this;this.eventCallbacks.forEach(function(n){var i;try{n.callback(t)}catch(o){(i=r.logger)===null||i===void 0||i.debug("an unexpected error occurred while triggering event callbacks",o)}})},e.prototype.handleNetworkRequestEvent=function(t,r,n,i,o,a,s){var u;if(!(a===void 0||s===void 0)){var c,l="GET";ti(r)?(c=r.url,l=r.method):c=(u=r==null?void 0:r.toString)===null||u===void 0?void 0:u.call(r),l=(n==null?void 0:n.method)||l;var d,f;i&&(d=i.status),o&&(f={name:o.name||"UnknownError",message:o.message||"An unknown error occurred"},d=0);var v=Math.floor(performance.now()-s),h=Math.floor(a+v),y=new ei(t,l,a,a,c,n,d,v,i,f,h);this.triggerEventCallbacks(y)}},e.prototype.getTimestamps=function(){var t,r;return{startTime:(t=Date.now)===null||t===void 0?void 0:t.call(Date),durationStart:(r=performance==null?void 0:performance.now)===null||r===void 0?void 0:r.call(performance)}},e.prototype.observeFetch=function(t){var r=this;!this.globalScope||!t||(this.globalScope.fetch=function(n,i){return b(r,void 0,void 0,function(){var o,a,s,u,c,l;return m(this,function(d){switch(d.label){case 0:try{o=this.getTimestamps()}catch(f){(c=this.logger)===null||c===void 0||c.debug("an unexpected error occurred while retrieving timestamps",f)}d.label=1;case 1:return d.trys.push([1,3,,4]),[4,t(n,i)];case 2:return a=d.sent(),[3,4];case 3:return u=d.sent(),s=u,[3,4];case 4:try{this.handleNetworkRequestEvent("fetch",n,i?new Xn(i):void 0,a?new Qn(a):void 0,s,o==null?void 0:o.startTime,o==null?void 0:o.durationStart)}catch(f){(l=this.logger)===null||l===void 0||l.debug("an unexpected error occurred while handling fetch",f)}if(a)return[2,a];throw s}})})})},e.prototype.observeXhr=function(t,r){if(!(!this.globalScope||!t||!r)){var n=this.globalScope.XMLHttpRequest.prototype,i=this;n.open=function(){for(var o,a,s=[],u=0;u<arguments.length;u++)s[u]=arguments[u];var c=this,l=k(s,2),d=l[0],f=l[1];try{c.$$AmplitudeAnalyticsEvent=T({method:d,url:(o=f==null?void 0:f.toString)===null||o===void 0?void 0:o.call(f)},i.getTimestamps())}catch(v){(a=i.logger)===null||a===void 0||a.debug("an unexpected error occurred while calling xhr open",v)}return t.apply(c,s)},n.send=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var s=this,u=o[0],c=s.$$AmplitudeAnalyticsEvent;return s.addEventListener("loadend",function(){var l;try{var d=s.getAllResponseHeaders(),f=s.getResponseHeader("content-length"),v=new Zn(s.status,d,f?parseInt(f,10):void 0),h=new Jn(u);c.status=s.status,i.handleNetworkRequestEvent("xhr",{url:c.url,method:c.method},h,v,void 0,c.startTime,c.durationStart)}catch(y){(l=i.logger)===null||l===void 0||l.debug("an unexpected error occurred while handling xhr send",y)}}),r.apply(s,o)}}},e}(),At=new ni,me=function(e,t){return typeof e=="boolean"?e:(e==null?void 0:e[t])!==!1},_r=function(e){return me(e,"attribution")},ii=function(e){return me(e,"fileDownloads")},oi=function(e){return me(e,"formInteractions")},Tr=function(e){return me(e,"pageViews")},kt=function(e){return me(e,"sessions")},wr=function(e){return typeof e=="object"&&(e.networkTracking===!0||typeof e.networkTracking=="object")},Sr=function(e){return typeof e=="boolean"?e:typeof e=="object"&&(e.elementInteractions===!0||typeof e.elementInteractions=="object")},ai=function(e){if(Sr(e.autocapture)&&typeof e.autocapture=="object"&&typeof e.autocapture.elementInteractions=="object")return e.autocapture.elementInteractions},si=function(e){if(wr(e.autocapture)){if(typeof e.autocapture=="object"&&typeof e.autocapture.networkTracking=="object")return e.autocapture.networkTracking;if(e.networkTrackingOptions)return e.networkTrackingOptions}},ui=function(e){var t=function(){return!1},r=void 0,n,i=e.pageCounter,o=Tr(e.defaultTracking);return o&&(t=void 0,n=void 0,e.defaultTracking&&typeof e.defaultTracking=="object"&&e.defaultTracking.pageViews&&typeof e.defaultTracking.pageViews=="object"&&("trackOn"in e.defaultTracking.pageViews&&(t=e.defaultTracking.pageViews.trackOn),"trackHistoryChanges"in e.defaultTracking.pageViews&&(r=e.defaultTracking.pageViews.trackHistoryChanges),"eventType"in e.defaultTracking.pageViews&&e.defaultTracking.pageViews.eventType&&(n=e.defaultTracking.pageViews.eventType))),{trackOn:t,trackHistoryChanges:r,eventType:n,pageCounter:i}},ci=function(e){return _r(e.defaultTracking)&&e.defaultTracking&&typeof e.defaultTracking=="object"&&e.defaultTracking.attribution&&typeof e.defaultTracking.attribution=="object"?T({},e.defaultTracking.attribution):{}},ze=function(e,t){for(var r=0;r<t.length;r++){var n=t[r],i=n.name,o=n.args,a=n.resolve,s=e&&e[i];if(typeof s=="function"){var u=s.apply(e,o);typeof a=="function"&&a(u==null?void 0:u.promise)}}return e},Ye=function(e){var t=e;return t&&t._q!==void 0},Ir="2.17.12",li="amplitude-ts",di="Web",fi="$remote",vi=function(){function e(){this.name="@amplitude/plugin-context-browser",this.type="before",this.library="".concat(li,"/").concat(Ir),typeof navigator<"u"&&(this.userAgent=navigator.userAgent)}return e.prototype.setup=function(t){return this.config=t,Promise.resolve(void 0)},e.prototype.execute=function(t){var r,n;return b(this,void 0,void 0,function(){var i,o,a,s;return m(this,function(u){return i=new Date().getTime(),o=(r=this.config.lastEventId)!==null&&r!==void 0?r:-1,a=(n=t.event_id)!==null&&n!==void 0?n:o+1,this.config.lastEventId=a,t.time||(this.config.lastEventTime=i),s=T(T(T(T(T(T(T(T({user_id:this.config.userId,device_id:this.config.deviceId,session_id:this.config.sessionId,time:i},this.config.appVersion&&{app_version:this.config.appVersion}),this.config.trackingOptions.platform&&{platform:di}),this.config.trackingOptions.language&&{language:$n()}),this.config.trackingOptions.ipAddress&&{ip:fi}),{insert_id:ue(),partner_id:this.config.partnerId,plan:this.config.plan}),this.config.ingestionMetadata&&{ingestion_metadata:{source_name:this.config.ingestionMetadata.sourceName,source_version:this.config.ingestionMetadata.sourceVersion}}),t),{event_id:a,library:this.library,user_agent:this.userAgent}),[2,s]})})},e}(),Ar=function(){function e(t){this.storage=t}return e.prototype.isEnabled=function(){return b(this,void 0,void 0,function(){var t,r,n,i;return m(this,function(o){switch(o.label){case 0:if(!this.storage)return[2,!1];t=String(Date.now()),r=new e(this.storage),n="AMP_TEST",o.label=1;case 1:return o.trys.push([1,4,5,7]),[4,r.set(n,t)];case 2:return o.sent(),[4,r.get(n)];case 3:return i=o.sent(),[2,i===t];case 4:return o.sent(),[2,!1];case 5:return[4,r.remove(n)];case 6:return o.sent(),[7];case 7:return[2]}})})},e.prototype.get=function(t){return b(this,void 0,void 0,function(){var r;return m(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getRaw(t)];case 1:return r=n.sent(),r?[2,JSON.parse(r)]:[2,void 0];case 2:return n.sent(),console.error("[Amplitude] Error: Could not get value from storage"),[2,void 0];case 3:return[2]}})})},e.prototype.getRaw=function(t){var r;return b(this,void 0,void 0,function(){return m(this,function(n){return[2,((r=this.storage)===null||r===void 0?void 0:r.getItem(t))||void 0]})})},e.prototype.set=function(t,r){var n;return b(this,void 0,void 0,function(){return m(this,function(i){try{(n=this.storage)===null||n===void 0||n.setItem(t,JSON.stringify(r))}catch{}return[2]})})},e.prototype.remove=function(t){var r;return b(this,void 0,void 0,function(){return m(this,function(n){try{(r=this.storage)===null||r===void 0||r.removeItem(t)}catch{}return[2]})})},e.prototype.reset=function(){var t;return b(this,void 0,void 0,function(){return m(this,function(r){try{(t=this.storage)===null||t===void 0||t.clear()}catch{}return[2]})})},e}(),_e=1e3,kr=function(e){z(t,e);function t(r){var n=this,i,o,a;try{a=(i=G())===null||i===void 0?void 0:i.localStorage}catch(s){(o=r==null?void 0:r.loggerProvider)===null||o===void 0||o.debug("Failed to access localStorage. error=".concat(JSON.stringify(s))),a=void 0}return n=e.call(this,a)||this,n.loggerProvider=r==null?void 0:r.loggerProvider,n}return t.prototype.set=function(r,n){var i;return b(this,void 0,void 0,function(){var o;return m(this,function(a){switch(a.label){case 0:return Array.isArray(n)&&n.length>_e?(o=n.length-_e,[4,e.prototype.set.call(this,r,n.slice(0,_e))]):[3,2];case 1:return a.sent(),(i=this.loggerProvider)===null||i===void 0||i.error("Failed to save ".concat(o," events because the queue length exceeded ").concat(_e,".")),[3,4];case 2:return[4,e.prototype.set.call(this,r,n)];case 3:a.sent(),a.label=4;case 4:return[2]}})})},t}(Ar),hi=function(e){z(t,e);function t(){var r;return e.call(this,(r=G())===null||r===void 0?void 0:r.sessionStorage)||this}return t}(Ar),pi=function(e){z(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.state={done:4},r}return t.prototype.send=function(r,n){return b(this,void 0,void 0,function(){var i=this;return m(this,function(o){return[2,new Promise(function(a,s){typeof XMLHttpRequest>"u"&&s(new Error("XHRTransport is not supported."));var u=new XMLHttpRequest;u.open("POST",r,!0),u.onreadystatechange=function(){if(u.readyState===i.state.done){var c=u.responseText;try{a(i.buildResponse(JSON.parse(c)))}catch{a(i.buildResponse({code:u.status}))}}},u.setRequestHeader("Content-Type","application/json"),u.setRequestHeader("Accept","*/*"),u.send(JSON.stringify(n))})]})})},t}(dt),gi=function(e){z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.send=function(r,n){return b(this,void 0,void 0,function(){var i=this;return m(this,function(o){return[2,new Promise(function(a,s){var u=G();if(!(u!=null&&u.navigator.sendBeacon))throw new Error("SendBeaconTransport is not supported");try{var c=JSON.stringify(n),l=u.navigator.sendBeacon(r,JSON.stringify(n));return a(l?i.buildResponse({code:200,events_ingested:n.events.length,payload_size_bytes:c.length,server_upload_time:Date.now()}):i.buildResponse({code:500}))}catch(d){s(d)}})]})})},t}(dt),mi=function(e,t,r){return r===void 0&&(r=!0),b(void 0,void 0,void 0,function(){var n,i,o,a,s,u,c,l,d;return m(this,function(f){switch(f.label){case 0:return n=jn(e),[4,t.getRaw(n)];case 1:return i=f.sent(),i?r?[4,t.remove(n)]:[3,3]:[2,{optOut:!1}];case 2:f.sent(),f.label=3;case 3:return o=k(i.split("."),6),a=o[0],s=o[1],u=o[2],c=o[3],l=o[4],d=o[5],[2,{deviceId:a,userId:yi(s),sessionId:Xe(c),lastEventId:Xe(d),lastEventTime:Xe(l),optOut:!!u}]}})})},Xe=function(e){var t=parseInt(e,32);if(!isNaN(t))return t},yi=function(e){if(!(!atob||!escape||!e))try{return decodeURIComponent(escape(atob(e)))}catch{return}},te="[Amplitude]",Pt="".concat(te," Form Started"),bi="".concat(te," Form Submitted"),Ei="".concat(te," File Downloaded"),Rt="session_start",Ct="session_end",_i="".concat(te," File Extension"),Ti="".concat(te," File Name"),wi="".concat(te," Link ID"),Si="".concat(te," Link Text"),Ii="".concat(te," Link URL"),Je="".concat(te," Form ID"),Qe="".concat(te," Form Name"),Ze="".concat(te," Form Destination"),Oe="cookie",Ai="US",ki=function(e){z(t,e);function t(r,n,i,o,a,s,u,c,l,d,f,v,h,y,_,p,g,E,S,I,w,P,C,R,U,N,M,j,K,H,ee,ne,ce,J,$){i===void 0&&(i=new ft),o===void 0&&(o={domain:"",expiration:365,sameSite:"Lax",secure:!1,upgrade:!0}),c===void 0&&(c=1e3),l===void 0&&(l=5),d===void 0&&(d=30),f===void 0&&(f=Oe),p===void 0&&(p=new gn),g===void 0&&(g=wt.Warn),S===void 0&&(S=!1),I===void 0&&(I=!1),C===void 0&&(C=""),R===void 0&&(R=Ai),N===void 0&&(N=30*60*1e3),M===void 0&&(M=new kr({loggerProvider:p})),j===void 0&&(j={ipAddress:!0,language:!0,platform:!0}),K===void 0&&(K="fetch"),H===void 0&&(H=!1),ee===void 0&&(ee=!0);var A=e.call(this,{apiKey:r,storageProvider:M,transportProvider:Pr(K)})||this;return A.apiKey=r,A.appVersion=n,A.cookieOptions=o,A.defaultTracking=a,A.autocapture=s,A.flushIntervalMillis=c,A.flushMaxRetries=l,A.flushQueueSize=d,A.identityStorage=f,A.ingestionMetadata=v,A.instanceName=h,A.loggerProvider=p,A.logLevel=g,A.minIdLength=E,A.offline=S,A.partnerId=w,A.plan=P,A.serverUrl=C,A.serverZone=R,A.sessionTimeout=N,A.storageProvider=M,A.trackingOptions=j,A.transport=K,A.useBatch=H,A.fetchRemoteConfig=ee,A.networkTrackingOptions=$,A.version=Ir,A._optOut=!1,A._cookieStorage=i,A.deviceId=u,A.lastEventId=y,A.lastEventTime=_,A.optOut=I,A.sessionId=U,A.pageCounter=ce,A.userId=ne,A.debugLogsEnabled=J,A.loggerProvider.enable(J?wt.Debug:A.logLevel),A.networkTrackingOptions=$,A}return Object.defineProperty(t.prototype,"cookieStorage",{get:function(){return this._cookieStorage},set:function(r){this._cookieStorage!==r&&(this._cookieStorage=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"deviceId",{get:function(){return this._deviceId},set:function(r){this._deviceId!==r&&(this._deviceId=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this._userId},set:function(r){this._userId!==r&&(this._userId=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){return this._sessionId},set:function(r){this._sessionId!==r&&(this._sessionId=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optOut",{get:function(){return this._optOut},set:function(r){this._optOut!==r&&(this._optOut=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventTime",{get:function(){return this._lastEventTime},set:function(r){this._lastEventTime!==r&&(this._lastEventTime=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventId",{get:function(){return this._lastEventId},set:function(r){this._lastEventId!==r&&(this._lastEventId=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageCounter",{get:function(){return this._pageCounter},set:function(r){this._pageCounter!==r&&(this._pageCounter=r,this.updateStorage())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"debugLogsEnabled",{set:function(r){this._debugLogsEnabled!==r&&(this._debugLogsEnabled=r,this.updateStorage())},enumerable:!1,configurable:!0}),t.prototype.updateStorage=function(){var r={deviceId:this._deviceId,userId:this._userId,sessionId:this._sessionId,optOut:this._optOut,lastEventTime:this._lastEventTime,lastEventId:this._lastEventId,pageCounter:this._pageCounter,debugLogsEnabled:this._debugLogsEnabled};this.cookieStorage.set(yr(this.apiKey),r)},t}(mn),Pi=function(e,t,r){return t===void 0&&(t={}),b(void 0,void 0,void 0,function(){var n,i,o,a,s,u,c,l,d,f,v,h,y,_,p,g,E,S,I,w,P,C,R,U,N,M,j,K,H,ee,ne,ce,J,$,A,qe,Ve,je,$e,Ge,Be,He,Ke;return m(this,function(ae){switch(ae.label){case 0:return n=t.identityStorage||Oe,I={},n===Oe?[3,1]:(o="",[3,5]);case 1:return(P=(w=t.cookieOptions)===null||w===void 0?void 0:w.domain)!==null&&P!==void 0?(a=P,[3,4]):[3,2];case 2:return[4,Ci()];case 3:a=ae.sent(),ae.label=4;case 4:o=a,ae.label=5;case 5:return i=T.apply(void 0,[(I.domain=o,I.expiration=365,I.sameSite="Lax",I.secure=!1,I.upgrade=!0,I),t.cookieOptions]),s=Ri(t.identityStorage,i),[4,mi(e,s,(R=(C=t.cookieOptions)===null||C===void 0?void 0:C.upgrade)!==null&&R!==void 0?R:!0)];case 6:return u=ae.sent(),[4,s.get(yr(e))];case 7:return c=ae.sent(),l=Ce(),d=(K=(j=(M=(N=(U=t.deviceId)!==null&&U!==void 0?U:l.ampDeviceId)!==null&&N!==void 0?N:l.deviceId)!==null&&M!==void 0?M:c==null?void 0:c.deviceId)!==null&&j!==void 0?j:u.deviceId)!==null&&K!==void 0?K:ue(),f=(H=c==null?void 0:c.lastEventId)!==null&&H!==void 0?H:u.lastEventId,v=(ee=c==null?void 0:c.lastEventTime)!==null&&ee!==void 0?ee:u.lastEventTime,h=(ce=(ne=t.optOut)!==null&&ne!==void 0?ne:c==null?void 0:c.optOut)!==null&&ce!==void 0?ce:u.optOut,y=(J=c==null?void 0:c.sessionId)!==null&&J!==void 0?J:u.sessionId,_=(A=($=t.userId)!==null&&$!==void 0?$:c==null?void 0:c.userId)!==null&&A!==void 0?A:u.userId,r.previousSessionDeviceId=(qe=c==null?void 0:c.deviceId)!==null&&qe!==void 0?qe:u.deviceId,r.previousSessionUserId=(Ve=c==null?void 0:c.userId)!==null&&Ve!==void 0?Ve:u.userId,p={ipAddress:($e=(je=t.trackingOptions)===null||je===void 0?void 0:je.ipAddress)!==null&&$e!==void 0?$e:!0,language:(Be=(Ge=t.trackingOptions)===null||Ge===void 0?void 0:Ge.language)!==null&&Be!==void 0?Be:!0,platform:(Ke=(He=t.trackingOptions)===null||He===void 0?void 0:He.platform)!==null&&Ke!==void 0?Ke:!0},g=c==null?void 0:c.pageCounter,E=c==null?void 0:c.debugLogsEnabled,t.autocapture!==void 0&&(t.defaultTracking=t.autocapture),S=new ki(e,t.appVersion,s,i,t.defaultTracking,t.autocapture,d,t.flushIntervalMillis,t.flushMaxRetries,t.flushQueueSize,n,t.ingestionMetadata,t.instanceName,f,v,t.loggerProvider,t.logLevel,t.minIdLength,t.offline,h,t.partnerId,t.plan,t.serverUrl,t.serverZone,y,t.sessionTimeout,t.storageProvider,p,t.transport,t.useBatch,t.fetchRemoteConfig,_,g,E,t.networkTrackingOptions),[4,S.storageProvider.isEnabled()];case 8:return ae.sent()||(S.loggerProvider.warn("Storage provider ".concat(S.storageProvider.constructor.name," is not enabled. Falling back to MemoryStorage.")),S.storageProvider=new ft),[2,S]}})})},Ri=function(e,t){switch(e===void 0&&(e=Oe),t===void 0&&(t={}),e){case"localStorage":return new kr;case"sessionStorage":return new hi;case"none":return new ft;case"cookie":default:return new at(T(T({},t),{expirationDays:t.expiration}))}},Pr=function(e){return e==="xhr"?new pi:e==="beacon"?new gi:new pn},Ci=function(e){return b(void 0,void 0,void 0,function(){var t,r,n,i,o,o,a,s,u,c;return m(this,function(l){switch(l.label){case 0:return[4,new at().isEnabled()];case 1:if(!l.sent()||typeof location>"u"||!location.hostname)return[2,""];for(t=location.hostname,r=t.split("."),n=[],i="AMP_TLDTEST",o=r.length-2;o>=0;--o)n.push(r.slice(o).join("."));o=0,l.label=2;case 2:return o<n.length?(a=n[o],s={domain:"."+a},u=new at(s),[4,u.set(i,1)]):[3,7];case 3:return l.sent(),[4,u.get(i)];case 4:return c=l.sent(),c?[4,u.remove(i)]:[3,6];case 5:return l.sent(),[2,"."+a];case 6:return o++,[3,2];case 7:return[2,""]}})})},Rr=function(){var e="ampIntegrationContext";if(typeof globalThis<"u"&&typeof globalThis[e]<"u")return globalThis[e];if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof global<"u")return global},Ot=function(){var e,t=Rr();if(!(!((e=t==null?void 0:t.location)===null||e===void 0)&&e.search))return{};var r=t.location.search.substring(1).split("&").filter(Boolean),n=r.reduce(function(i,o){var a=o.split("=",2),s=Lt(a[0]),u=Lt(a[1]);return u&&(i[s]=u),i},{});return n},Lt=function(e){e===void 0&&(e="");try{return decodeURIComponent(e)}catch{return""}},Oi="utm_campaign",Li="utm_content",Ni="utm_id",xi="utm_medium",Di="utm_source",Ui="utm_term",Nt="dclid",xt="fbclid",Dt="gbraid",Ut="gclid",Mt="ko_click_id",Ft="li_fat_id",qt="msclkid",Vt="rtd_cid",jt="ttclid",$t="twclid",Gt="wbraid",Cr={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rtd_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},Mi=function(){function e(){}return e.prototype.parse=function(){return b(this,void 0,void 0,function(){return m(this,function(t){return[2,T(T(T(T({},Cr),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},e.prototype.getUtmParam=function(){var t=Ot(),r=t[Oi],n=t[Li],i=t[Ni],o=t[xi],a=t[Di],s=t[Ui];return{utm_campaign:r,utm_content:n,utm_id:i,utm_medium:o,utm_source:a,utm_term:s}},e.prototype.getReferrer=function(){var t,r,n={referrer:void 0,referring_domain:void 0};try{n.referrer=document.referrer||void 0,n.referring_domain=(r=(t=n.referrer)===null||t===void 0?void 0:t.split("/")[2])!==null&&r!==void 0?r:void 0}catch{}return n},e.prototype.getClickIds=function(){var t,r=Ot();return t={},t[Nt]=r[Nt],t[xt]=r[xt],t[Dt]=r[Dt],t[Ut]=r[Ut],t[Mt]=r[Mt],t[Ft]=r[Ft],t[qt]=r[qt],t[Vt]=r[Vt],t[jt]=r[jt],t[$t]=r[$t],t[Gt]=r[Gt],t},e}(),Le;(function(e){e.SET="$set",e.SET_ONCE="$setOnce",e.ADD="$add",e.APPEND="$append",e.PREPEND="$prepend",e.REMOVE="$remove",e.PREINSERT="$preInsert",e.POSTINSERT="$postInsert",e.UNSET="$unset",e.CLEAR_ALL="$clearAll"})(Le||(Le={}));var Bt;(function(e){e.REVENUE_PRODUCT_ID="$productId",e.REVENUE_QUANTITY="$quantity",e.REVENUE_PRICE="$price",e.REVENUE_TYPE="$revenueType",e.REVENUE_CURRENCY="$currency",e.REVENUE="$revenue"})(Bt||(Bt={}));var Ht;(function(e){e.IDENTIFY="$identify",e.GROUP_IDENTIFY="$groupidentify",e.REVENUE="revenue_amount"})(Ht||(Ht={}));var Ne;(function(e){e.US="US",e.EU="EU"})(Ne||(Ne={}));var xe;(function(e){e.Unknown="unknown",e.Skipped="skipped",e.Success="success",e.RateLimit="rate_limit",e.PayloadTooLarge="payload_too_large",e.Invalid="invalid",e.Failed="failed",e.Timeout="Timeout",e.SystemError="SystemError"})(xe||(xe={}));var Fi=function(e){var t={};for(var r in e){var n=e[r];n&&(t[r]=n)}return t},qi="[Amplitude] Page Viewed",Vi=function(e){e===void 0&&(e={});var t,r=Rr(),n=void 0,i=!1,o,a=e.trackOn,s=e.trackHistoryChanges,u=e.eventType,c=u===void 0?qi:u,l=function(p){var g=p;try{g=decodeURI(p)}catch(E){n==null||n.error("Malformed URI sequence: ",E)}return g},d=function(){return b(void 0,void 0,void 0,function(){var p,g,E;return m(this,function(S){switch(S.label){case 0:return p=l(typeof location<"u"&&location.href||""),E={event_type:c},g=[{}],[4,ji()];case 1:return[2,(E.event_properties=T.apply(void 0,[T.apply(void 0,g.concat([S.sent()])),{"[Amplitude] Page Domain":typeof location<"u"&&location.hostname||"","[Amplitude] Page Location":p,"[Amplitude] Page Path":typeof location<"u"&&l(location.pathname)||"","[Amplitude] Page Title":typeof document<"u"&&document.title||"","[Amplitude] Page URL":p.split("?")[0]}]),E)]}})})},f=function(){return typeof a>"u"||typeof a=="function"&&a()},v=typeof location<"u"?location.href:null,h=function(){return b(void 0,void 0,void 0,function(){var p,g,E,S;return m(this,function(I){switch(I.label){case 0:return p=location.href,g=Gi(s,p,v||"")&&f(),v=p,g?(n==null||n.log("Tracking page view event"),t!=null?[3,1]:[3,3]):[3,4];case 1:return S=(E=t).track,[4,d()];case 2:S.apply(E,[I.sent()]),I.label=3;case 3:I.label=4;case 4:return[2]}})})},y=function(){h()},_={name:"@amplitude/plugin-page-view-tracking-browser",type:"enrichment",setup:function(p,g){return b(void 0,void 0,void 0,function(){var E,S;return m(this,function(I){switch(I.label){case 0:return t=g,o=p,n=p.loggerProvider,n.log("Installing @amplitude/plugin-page-view-tracking-browser"),i=!0,r&&(r.addEventListener("popstate",y),r.history.pushState=new Proxy(r.history.pushState,{apply:function(w,P,C){var R=k(C,3),U=R[0],N=R[1],M=R[2];w.apply(P,[U,N,M]),i&&h()}})),f()?(n.log("Tracking page view event"),S=(E=t).track,[4,d()]):[3,2];case 1:S.apply(E,[I.sent()]),I.label=2;case 2:return[2]}})})},execute:function(p){return b(void 0,void 0,void 0,function(){var g;return m(this,function(E){switch(E.label){case 0:return a==="attribution"&&$i(p)?(n==null||n.log("Enriching campaign event to page view event with campaign parameters"),[4,d()]):[3,2];case 1:g=E.sent(),p.event_type=g.event_type,p.event_properties=T(T({},p.event_properties),g.event_properties),E.label=2;case 2:return o&&p.event_type===c&&(o.pageCounter=o.pageCounter?o.pageCounter+1:1,p.event_properties=T(T({},p.event_properties),{"[Amplitude] Page Counter":o.pageCounter})),[2,p]}})})},teardown:function(){return b(void 0,void 0,void 0,function(){return m(this,function(p){return r&&(r.removeEventListener("popstate",y),i=!1),[2]})})}};return _},ji=function(){return b(void 0,void 0,void 0,function(){var e;return m(this,function(t){switch(t.label){case 0:return e=Fi,[4,new Mi().parse()];case 1:return[2,e.apply(void 0,[t.sent()])]}})})},$i=function(e){if(e.event_type==="$identify"&&e.user_properties){var t=e.user_properties,r=t[Le.SET]||{},n=t[Le.UNSET]||{},i=D(D([],k(Object.keys(r)),!1),k(Object.keys(n)),!1);return Object.keys(Cr).every(function(o){return i.includes(o)})}return!1},Gi=function(e,t,r){switch(e){case"pathOnly":{if(r=="")return!0;var n=new URL(t),i=new URL(r),o=n.origin+n.pathname,a=i.origin+i.pathname;return o!==a}default:return t!==r}},Bi=function(){var e,t=[],r=function(c,l,d){c.addEventListener(l,d),t.push({element:c,type:l,handler:d})},n=function(){t.forEach(function(c){var l=c.element,d=c.type,f=c.handler;l==null||l.removeEventListener(d,f)}),t=[]},i="@amplitude/plugin-form-interaction-tracking-browser",o="enrichment",a=function(c,l){return b(void 0,void 0,void 0,function(){var d,f;return m(this,function(v){return d=function(){if(!l){c.loggerProvider.warn("Form interaction tracking requires a later version of @amplitude/analytics-browser. Form interaction events are not tracked.");return}if(!(typeof document>"u")){var h=function(_){var p=!1;r(_,"change",function(){var g,E=Kt(_);p||l.track(Pt,(g={},g[Je]=le(_.id),g[Qe]=le(_.name),g[Ze]=E,g)),p=!0}),r(_,"submit",function(){var g,E,S=Kt(_);p||l.track(Pt,(g={},g[Je]=le(_.id),g[Qe]=le(_.name),g[Ze]=S,g)),l.track(bi,(E={},E[Je]=le(_.id),E[Qe]=le(_.name),E[Ze]=S,E)),p=!1})},y=Array.from(document.getElementsByTagName("form"));y.forEach(h),typeof MutationObserver<"u"&&(e=new MutationObserver(function(_){_.forEach(function(p){p.addedNodes.forEach(function(g){g.nodeName==="FORM"&&h(g),"querySelectorAll"in g&&typeof g.querySelectorAll=="function"&&Array.from(g.querySelectorAll("form")).map(h)})})}),e.observe(document.body,{subtree:!0,childList:!0}))}},document.readyState==="complete"?d():(f=G(),f?f.addEventListener("load",d):c.loggerProvider.debug("Form interaction tracking is not installed because global is undefined.")),[2]})})},s=function(c){return b(void 0,void 0,void 0,function(){return m(this,function(l){return[2,c]})})},u=function(){return b(void 0,void 0,void 0,function(){return m(this,function(c){return e==null||e.disconnect(),n(),[2]})})};return{name:i,type:o,setup:a,execute:s,teardown:u}},le=function(e){if(typeof e=="string")return e},Kt=function(e){var t=e.getAttribute("action");try{t=new URL(encodeURI(t??""),window.location.href).href}catch{}return t},Hi=function(){var e,t=[],r=function(c,l,d){c.addEventListener(l,d),t.push({element:c,type:l,handler:d})},n=function(){t.forEach(function(c){var l=c.element,d=c.type,f=c.handler;l==null||l.removeEventListener(d,f)}),t=[]},i="@amplitude/plugin-file-download-tracking-browser",o="enrichment",a=function(c,l){return b(void 0,void 0,void 0,function(){var d,f;return m(this,function(v){return d=function(){if(!l){c.loggerProvider.warn("File download tracking requires a later version of @amplitude/analytics-browser. File download events are not tracked.");return}if(!(typeof document>"u")){var h=function(p){var g;try{g=new URL(p.href,window.location.href)}catch{return}var E=y.exec(g.href),S=E==null?void 0:E[1];S&&r(p,"click",function(){var I;S&&l.track(Ei,(I={},I[_i]=S,I[Ti]=g.pathname,I[wi]=p.id,I[Si]=p.text,I[Ii]=p.href,I))})},y=/\.(pdf|xlsx?|docx?|txt|rtf|csv|exe|key|pp(s|t|tx)|7z|pkg|rar|gz|zip|avi|mov|mp4|mpe?g|wmv|midi?|mp3|wav|wma)(\?.+)?$/,_=Array.from(document.getElementsByTagName("a"));_.forEach(h),typeof MutationObserver<"u"&&(e=new MutationObserver(function(p){p.forEach(function(g){g.addedNodes.forEach(function(E){E.nodeName==="A"&&h(E),"querySelectorAll"in E&&typeof E.querySelectorAll=="function"&&Array.from(E.querySelectorAll("a")).map(h)})})}),e.observe(document.body,{subtree:!0,childList:!0}))}},document.readyState==="complete"?d():(f=G(),f?f.addEventListener("load",d):c.loggerProvider.debug("File download tracking is not installed because global is undefined.")),[2]})})},s=function(c){return b(void 0,void 0,void 0,function(){return m(this,function(l){return[2,c]})})},u=function(){return b(void 0,void 0,void 0,function(){return m(this,function(c){return e==null||e.disconnect(),n(),[2]})})};return{name:i,type:o,setup:a,execute:s,teardown:u}},Wt=!1,Ki=function(e){if(!(Wt||e.defaultTracking!==void 0)){var t=`\`options.defaultTracking\` is set to undefined. This implicitly configures your Amplitude instance to track Page Views, Sessions, File Downloads, and Form Interactions. You can suppress this warning by explicitly setting a value to \`options.defaultTracking\`. The value must either be a boolean, to enable and disable all default events, or an object, for advanced configuration. For example:

amplitude.init(<YOUR_API_KEY>, {
  defaultTracking: true,
});

Visit https://www.docs.developers.amplitude.com/data/sdks/browser-2/#tracking-default-events for more details.`;e.loggerProvider.warn(t),Wt=!0}},Wi=function(){var e="@amplitude/plugin-network-checker-browser",t="before",r=G(),n=[],i=function(u,c){r!=null&&r.addEventListener&&(r==null||r.addEventListener(u,c),n.push({type:u,handler:c}))},o=function(){n.forEach(function(u){var c=u.type,l=u.handler;r==null||r.removeEventListener(c,l)}),n=[]},a=function(u,c){return b(void 0,void 0,void 0,function(){return m(this,function(l){return typeof navigator>"u"?(u.loggerProvider.debug("Network connectivity checker plugin is disabled because navigator is not available."),u.offline=!1,[2]):(u.offline=!navigator.onLine,i("online",function(){u.loggerProvider.debug("Network connectivity changed to online."),u.offline=!1,setTimeout(function(){c.flush()},u.flushIntervalMillis)}),i("offline",function(){u.loggerProvider.debug("Network connectivity changed to offline."),u.offline=!0}),[2])})})},s=function(){return b(void 0,void 0,void 0,function(){return m(this,function(u){return o(),[2]})})};return{name:e,type:t,setup:a,teardown:s}},zi="Network error occurred, remote config fetch failed",Yi="Remote config successfully fetched",Xi="Remote config fetch rejected due to exceeded retry count",zt="Remote config fetch rejected due to timeout after 5 seconds",Yt="Unexpected error occurred",Ji="https://sr-client-cfg.amplitude.com/config",Qi="https://sr-client-cfg.stag2.amplitude.com/config",Zi="https://sr-client-cfg.eu.amplitude.com/config",eo=function(){function e(t){var r=t.localConfig,n=t.configKeys,i=this;this.retryTimeout=1e3,this.attempts=0,this.sessionTargetingMatch=!1,this.metrics={},this.getRemoteConfig=function(o,a,s){return b(i,void 0,void 0,function(){var u,c,l;return m(this,function(d){switch(d.label){case 0:return u=Date.now(),[4,this.fetchWithTimeout(s)];case 1:return c=d.sent(),c&&(l=c.configs&&c.configs[o],l)?(this.metrics.fetchTimeAPISuccess=Date.now()-u,[2,l[a]]):(this.metrics.fetchTimeAPIFail=Date.now()-u,[2,void 0])}})})},this.fetchWithTimeout=function(o){return b(i,void 0,void 0,function(){var a,s,u;return m(this,function(c){switch(c.label){case 0:return a=new AbortController,s=setTimeout(function(){return a.abort()},5e3),[4,this.fetchRemoteConfig(a.signal,o)];case 1:return u=c.sent(),clearTimeout(s),[2,u]}})})},this.fetchRemoteConfig=function(o,a){return b(i,void 0,void 0,function(){var s,u,c,l,d,f,v,h,y,_,p,g,E;return m(this,function(S){switch(S.label){case 0:if(a===this.lastFetchedSessionId&&this.attempts>=this.localConfig.flushMaxRetries)return[2,this.completeRequest({err:Xi})];if(o.aborted)return[2,this.completeRequest({err:zt})];a!==this.lastFetchedSessionId&&(this.lastFetchedSessionId=a,this.attempts=0),S.label=1;case 1:S.trys.push([1,3,,4]),s=new URLSearchParams({api_key:this.localConfig.apiKey});try{for(u=x(this.configKeys),c=u.next();!c.done;c=u.next())l=c.value,s.append("config_keys",l)}catch(I){p={error:I}}finally{try{c&&!c.done&&(g=u.return)&&g.call(u)}finally{if(p)throw p.error}}return a&&s.set("session_id",String(a)),d={headers:{Accept:"*/*"},method:"GET"},f="".concat(this.getServerUrl(),"?").concat(s.toString()),this.attempts+=1,[4,fetch(f,T(T({},d),{signal:o}))];case 2:if(v=S.sent(),v===null)return[2,this.completeRequest({err:Yt})];switch(h=new dt().buildStatus(v.status),h){case xe.Success:return this.attempts=0,[2,this.parseAndStoreConfig(v)];case xe.Failed:return[2,this.retryFetch(o,a)];default:return[2,this.completeRequest({err:zi})]}case 3:return y=S.sent(),_=y,o.aborted?[2,this.completeRequest({err:zt})]:[2,this.completeRequest({err:(E=_.message)!==null&&E!==void 0?E:Yt})];case 4:return[2]}})})},this.retryFetch=function(o,a){return b(i,void 0,void 0,function(){var s=this;return m(this,function(u){switch(u.label){case 0:return[4,new Promise(function(c){return setTimeout(c,s.attempts*s.retryTimeout)})];case 1:return u.sent(),[2,this.fetchRemoteConfig(o,a)]}})})},this.parseAndStoreConfig=function(o){return b(i,void 0,void 0,function(){var a;return m(this,function(s){switch(s.label){case 0:return[4,o.json()];case 1:return a=s.sent(),this.completeRequest({success:Yi}),[2,a]}})})},this.localConfig=r,this.configKeys=n}return e.prototype.getServerUrl=function(){return this.localConfig.serverZone===Ne.STAGING?Qi:this.localConfig.serverZone===Ne.EU?Zi:Ji},e.prototype.completeRequest=function(t){var r=t.err,n=t.success;if(r)throw new Error(r);n&&this.localConfig.loggerProvider.log(n)},e}(),to=function(e){var t=e.localConfig,r=e.configKeys;return b(void 0,void 0,void 0,function(){return m(this,function(n){return[2,new eo({localConfig:t,configKeys:r})]})})},ro=to,no=function(){function e(t){this.config=t,this.config.loggerProvider.debug("Local configuration before merging with remote config",JSON.stringify(this.config,null,2))}return e.prototype.initialize=function(){return b(this,void 0,void 0,function(){var t;return m(this,function(r){switch(r.label){case 0:return t=this,[4,ro({localConfig:this.config,configKeys:["analyticsSDK"]})];case 1:return t.remoteConfigFetch=r.sent(),[2]}})})},e.prototype.generateJoinedConfig=function(){var t,r,n,i,o,a;return b(this,void 0,void 0,function(){var s,u,c,l,d,f,v,h,y,_,p,g,E;return m(this,function(S){switch(S.label){case 0:return S.trys.push([0,3,,4]),u=this.remoteConfigFetch,u?[4,this.remoteConfigFetch.getRemoteConfig("analyticsSDK","browserSDK",this.config.sessionId)]:[3,2];case 1:u=S.sent(),S.label=2;case 2:if(s=u,this.config.loggerProvider.debug("Remote configuration:",JSON.stringify(s,null,2)),s&&"autocapture"in s){if(typeof s.autocapture=="boolean"&&(this.config.autocapture=s.autocapture),typeof s.autocapture=="object"){if(c=T({},s.autocapture),this.config.autocapture===void 0&&(this.config.autocapture=s.autocapture),typeof s.autocapture.elementInteractions=="object"&&(!((t=s.autocapture.elementInteractions.pageUrlAllowlistRegex)===null||t===void 0)&&t.length)){c.elementInteractions=T({},s.autocapture.elementInteractions),l=c.elementInteractions,d=(r=l.pageUrlAllowlist)!==null&&r!==void 0?r:[],f=[];try{for(v=x(s.autocapture.elementInteractions.pageUrlAllowlistRegex),h=v.next();!h.done;h=v.next()){y=h.value;try{f.push(new RegExp(y))}catch(I){this.config.loggerProvider.warn("Invalid regex pattern: ".concat(y),I)}}}catch(I){g={error:I}}finally{try{h&&!h.done&&(E=v.return)&&E.call(v)}finally{if(g)throw g.error}}_=d.concat(f),l.pageUrlAllowlist=_,delete l.pageUrlAllowlistRegex}typeof this.config.autocapture=="boolean"&&(this.config.autocapture=T({attribution:this.config.autocapture,fileDownloads:this.config.autocapture,formInteractions:this.config.autocapture,pageViews:this.config.autocapture,sessions:this.config.autocapture,elementInteractions:this.config.autocapture},c)),typeof this.config.autocapture=="object"&&(this.config.autocapture=T(T({},this.config.autocapture),c))}this.config.defaultTracking=this.config.autocapture}return this.config.loggerProvider.debug("Joined configuration: ",JSON.stringify(this.config,null,2)),(n=(a=this.config).requestMetadata)!==null&&n!==void 0||(a.requestMetadata=new hr),!((i=this.remoteConfigFetch)===null||i===void 0)&&i.metrics.fetchTimeAPISuccess&&this.config.requestMetadata.recordHistogram("remote_config_fetch_time_API_success",this.remoteConfigFetch.metrics.fetchTimeAPISuccess),!((o=this.remoteConfigFetch)===null||o===void 0)&&o.metrics.fetchTimeAPIFail&&this.config.requestMetadata.recordHistogram("remote_config_fetch_time_API_fail",this.remoteConfigFetch.metrics.fetchTimeAPIFail),[3,4];case 3:return p=S.sent(),this.config.loggerProvider.error("Failed to fetch remote configuration because of error: ",p),[3,4];case 4:return[2,this.config]}})})},e}(),io=function(e){return b(void 0,void 0,void 0,function(){var t;return m(this,function(r){switch(r.label){case 0:return t=new no(e),[4,t.initialize()];case 1:return r.sent(),[2,t]}})})},oo="@amplitude/plugin-autocapture-browser",st="[Amplitude] Element Clicked",ao="[Amplitude] Element Changed",so="[Amplitude] Element ID",uo="[Amplitude] Element Class",Or="[Amplitude] Element Tag",Lr="[Amplitude] Element Text",co="[Amplitude] Element Hierarchy",lo="[Amplitude] Element Href",fo="[Amplitude] Element Position Left",vo="[Amplitude] Element Position Top",ho="[Amplitude] Element Aria Label",po="[Amplitude] Element Attributes",go="[Amplitude] Element Parent Label",Nr="[Amplitude] Page URL",mo="[Amplitude] Page Title",yo="[Amplitude] Viewport Height",bo="[Amplitude] Viewport Width",Ie="https://app.amplitude.com",Eo="https://app.eu.amplitude.com",_o="https://apps.stag2.amplitude.com",To={US:Ie,EU:Eo,STAGING:_o},wo="https://cdn.amplitude.com/libs/visual-tagging-selector-1.0.0-alpha.js.gz",So="amp-visual-tagging-selector-highlight";function L(e){return typeof e=="function"}function vt(e){var t=function(n){Error.call(n),n.stack=new Error().stack},r=e(t);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var et=vt(function(e){return function(r){e(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function De(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var ye=function(){function e(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var t,r,n,i,o;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var s=x(a),u=s.next();!u.done;u=s.next()){var c=u.value;c.remove(this)}}catch(y){t={error:y}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}else a.remove(this);var l=this.initialTeardown;if(L(l))try{l()}catch(y){o=y instanceof et?y.errors:[y]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var f=x(d),v=f.next();!v.done;v=f.next()){var h=v.value;try{Xt(h)}catch(y){o=o??[],y instanceof et?o=D(D([],k(o)),k(y.errors)):o.push(y)}}}catch(y){n={error:y}}finally{try{v&&!v.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}}if(o)throw new et(o)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)Xt(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(t)}},e.prototype._hasParent=function(t){var r=this._parentage;return r===t||Array.isArray(r)&&r.includes(t)},e.prototype._addParent=function(t){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(t),r):r?[r,t]:t},e.prototype._removeParent=function(t){var r=this._parentage;r===t?this._parentage=null:Array.isArray(r)&&De(r,t)},e.prototype.remove=function(t){var r=this._finalizers;r&&De(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=function(){var t=new e;return t.closed=!0,t}(),e}(),xr=ye.EMPTY;function Dr(e){return e instanceof ye||e&&"closed"in e&&L(e.remove)&&L(e.add)&&L(e.unsubscribe)}function Xt(e){L(e)?e():e.unsubscribe()}var Io={Promise:void 0},Ao={setTimeout:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,D([e,t],k(r)))},clearTimeout:function(e){return clearTimeout(e)},delegate:void 0};function Ur(e){Ao.setTimeout(function(){throw e})}function ut(){}function Ae(e){e()}var ht=function(e){z(t,e);function t(r){var n=e.call(this)||this;return n.isStopped=!1,r?(n.destination=r,Dr(r)&&r.add(n)):n.destination=Ro,n}return t.create=function(r,n,i){return new pe(r,n,i)},t.prototype.next=function(r){this.isStopped||this._next(r)},t.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(r){this.destination.next(r)},t.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(ye),ko=function(){function e(t){this.partialObserver=t}return e.prototype.next=function(t){var r=this.partialObserver;if(r.next)try{r.next(t)}catch(n){Te(n)}},e.prototype.error=function(t){var r=this.partialObserver;if(r.error)try{r.error(t)}catch(n){Te(n)}else Te(t)},e.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(r){Te(r)}},e}(),pe=function(e){z(t,e);function t(r,n,i){var o=e.call(this)||this,a;return L(r)||!r?a={next:r??void 0,error:n??void 0,complete:i??void 0}:a=r,o.destination=new ko(a),o}return t}(ht);function Te(e){Ur(e)}function Po(e){throw e}var Ro={closed:!0,next:ut,error:Po,complete:ut},pt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Mr(e){return e}function Co(e){return e.length===0?Mr:e.length===1?e[0]:function(r){return e.reduce(function(n,i){return i(n)},r)}}var B=function(){function e(t){t&&(this._subscribe=t)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(t,r,n){var i=this,o=Lo(t)?t:new pe(t,r,n);return Ae(function(){var a=i,s=a.operator,u=a.source;o.add(s?s.call(o,u):u?i._subscribe(o):i._trySubscribe(o))}),o},e.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(r){t.error(r)}},e.prototype.forEach=function(t,r){var n=this;return r=Jt(r),new r(function(i,o){var a=new pe({next:function(s){try{t(s)}catch(u){o(u),a.unsubscribe()}},error:o,complete:i});n.subscribe(a)})},e.prototype._subscribe=function(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)},e.prototype[pt]=function(){return this},e.prototype.pipe=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Co(t)(this)},e.prototype.toPromise=function(t){var r=this;return t=Jt(t),new t(function(n,i){var o;r.subscribe(function(a){return o=a},function(a){return i(a)},function(){return n(o)})})},e.create=function(t){return new e(t)},e}();function Jt(e){var t;return(t=e??Io.Promise)!==null&&t!==void 0?t:Promise}function Oo(e){return e&&L(e.next)&&L(e.error)&&L(e.complete)}function Lo(e){return e&&e instanceof ht||Oo(e)&&Dr(e)}function No(e){return L(e==null?void 0:e.lift)}function Z(e){return function(t){if(No(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Y(e,t,r,n,i){return new xo(e,t,r,n,i)}var xo=function(e){z(t,e);function t(r,n,i,o,a,s){var u=e.call(this,r)||this;return u.onFinalize=a,u.shouldUnsubscribe=s,u._next=n?function(c){try{n(c)}catch(l){r.error(l)}}:e.prototype._next,u._error=o?function(c){try{o(c)}catch(l){r.error(l)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=i?function(){try{i()}catch(c){r.error(c)}finally{this.unsubscribe()}}:e.prototype._complete,u}return t.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},t}(ht),Do=vt(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Fr=function(e){z(t,e);function t(){var r=e.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return t.prototype.lift=function(r){var n=new Qt(this,this);return n.operator=r,n},t.prototype._throwIfClosed=function(){if(this.closed)throw new Do},t.prototype.next=function(r){var n=this;Ae(function(){var i,o;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var a=x(n.currentObservers),s=a.next();!s.done;s=a.next()){var u=s.value;u.next(r)}}catch(c){i={error:c}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(i)throw i.error}}}})},t.prototype.error=function(r){var n=this;Ae(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var i=n.observers;i.length;)i.shift().error(r)}})},t.prototype.complete=function(){var r=this;Ae(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(r){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,r)},t.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},t.prototype._innerSubscribe=function(r){var n=this,i=this,o=i.hasError,a=i.isStopped,s=i.observers;return o||a?xr:(this.currentObservers=null,s.push(r),new ye(function(){n.currentObservers=null,De(s,r)}))},t.prototype._checkFinalizedStatuses=function(r){var n=this,i=n.hasError,o=n.thrownError,a=n.isStopped;i?r.error(o):a&&r.complete()},t.prototype.asObservable=function(){var r=new B;return r.source=this,r},t.create=function(r,n){return new Qt(r,n)},t}(B),Qt=function(e){z(t,e);function t(r,n){var i=e.call(this)||this;return i.destination=r,i.source=n,i}return t.prototype.next=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,r)},t.prototype.error=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,r)},t.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},t.prototype._subscribe=function(r){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&i!==void 0?i:xr},t}(Fr),Uo={now:function(){return Date.now()}},Mo=function(e){z(t,e);function t(r,n){return e.call(this)||this}return t.prototype.schedule=function(r,n){return this},t}(ye),Zt={setInterval:function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setInterval.apply(void 0,D([e,t],k(r)))},clearInterval:function(e){return clearInterval(e)},delegate:void 0},Fo=function(e){z(t,e);function t(r,n){var i=e.call(this,r,n)||this;return i.scheduler=r,i.work=n,i.pending=!1,i}return t.prototype.schedule=function(r,n){var i;if(n===void 0&&(n=0),this.closed)return this;this.state=r;var o=this.id,a=this.scheduler;return o!=null&&(this.id=this.recycleAsyncId(a,o,n)),this.pending=!0,this.delay=n,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(a,this.id,n),this},t.prototype.requestAsyncId=function(r,n,i){return i===void 0&&(i=0),Zt.setInterval(r.flush.bind(r,this),i)},t.prototype.recycleAsyncId=function(r,n,i){if(i===void 0&&(i=0),i!=null&&this.delay===i&&this.pending===!1)return n;n!=null&&Zt.clearInterval(n)},t.prototype.execute=function(r,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(r,n);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},t.prototype._execute=function(r,n){var i=!1,o;try{this.work(r)}catch(a){i=!0,o=a||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),o},t.prototype.unsubscribe=function(){if(!this.closed){var r=this,n=r.id,i=r.scheduler,o=i.actions;this.work=this.state=this.scheduler=null,this.pending=!1,De(o,this),n!=null&&(this.id=this.recycleAsyncId(i,n,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},t}(Mo),er=function(){function e(t,r){r===void 0&&(r=e.now),this.schedulerActionCtor=t,this.now=r}return e.prototype.schedule=function(t,r,n){return r===void 0&&(r=0),new this.schedulerActionCtor(this,t).schedule(n,r)},e.now=Uo.now,e}(),qo=function(e){z(t,e);function t(r,n){n===void 0&&(n=er.now);var i=e.call(this,r,n)||this;return i.actions=[],i._active=!1,i}return t.prototype.flush=function(r){var n=this.actions;if(this._active){n.push(r);return}var i;this._active=!0;do if(i=r.execute(r.state,r.delay))break;while(r=n.shift());if(this._active=!1,i){for(;r=n.shift();)r.unsubscribe();throw i}},t}(er),Me=new qo(Fo),Vo=Me,gt=new B(function(e){return e.complete()});function qr(e){return e&&L(e.schedule)}function Vr(e){return e[e.length-1]}function jo(e){return qr(Vr(e))?e.pop():void 0}function $o(e,t){return typeof Vr(e)=="number"?e.pop():t}var mt=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function jr(e){return L(e==null?void 0:e.then)}function $r(e){return L(e[pt])}function Gr(e){return Symbol.asyncIterator&&L(e==null?void 0:e[Symbol.asyncIterator])}function Br(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Go(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Hr=Go();function Kr(e){return L(e==null?void 0:e[Hr])}function Wr(e){return dn(this,arguments,function(){var r,n,i,o;return m(this,function(a){switch(a.label){case 0:r=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,We(r.read())];case 3:return n=a.sent(),i=n.value,o=n.done,o?[4,We(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,We(i)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function zr(e){return L(e==null?void 0:e.getReader)}function X(e){if(e instanceof B)return e;if(e!=null){if($r(e))return Bo(e);if(mt(e))return Ho(e);if(jr(e))return Ko(e);if(Gr(e))return Yr(e);if(Kr(e))return Wo(e);if(zr(e))return zo(e)}throw Br(e)}function Bo(e){return new B(function(t){var r=e[pt]();if(L(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Ho(e){return new B(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function Ko(e){return new B(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,Ur)})}function Wo(e){return new B(function(t){var r,n;try{for(var i=x(e),o=i.next();!o.done;o=i.next()){var a=o.value;if(t.next(a),t.closed)return}}catch(s){r={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}t.complete()})}function Yr(e){return new B(function(t){Yo(e,t).catch(function(r){return t.error(r)})})}function zo(e){return Yr(Wr(e))}function Yo(e,t){var r,n,i,o;return b(this,void 0,void 0,function(){var a,s;return m(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),r=fn(e),u.label=1;case 1:return[4,r.next()];case 2:if(n=u.sent(),!!n.done)return[3,4];if(a=n.value,t.next(a),t.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s=u.sent(),i={error:s},[3,11];case 6:return u.trys.push([6,,9,10]),n&&!n.done&&(o=r.return)?[4,o.call(r)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function oe(e,t,r,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var o=t.schedule(function(){r(),i?e.add(this.schedule(null,n)):this.unsubscribe()},n);if(e.add(o),!i)return o}function Xr(e,t){return t===void 0&&(t=0),Z(function(r,n){r.subscribe(Y(n,function(i){return oe(n,e,function(){return n.next(i)},t)},function(){return oe(n,e,function(){return n.complete()},t)},function(i){return oe(n,e,function(){return n.error(i)},t)}))})}function Jr(e,t){return t===void 0&&(t=0),Z(function(r,n){n.add(e.schedule(function(){return r.subscribe(n)},t))})}function Xo(e,t){return X(e).pipe(Jr(t),Xr(t))}function Jo(e,t){return X(e).pipe(Jr(t),Xr(t))}function Qo(e,t){return new B(function(r){var n=0;return t.schedule(function(){n===e.length?r.complete():(r.next(e[n++]),r.closed||this.schedule())})})}function Zo(e,t){return new B(function(r){var n;return oe(r,t,function(){n=e[Hr](),oe(r,t,function(){var i,o,a;try{i=n.next(),o=i.value,a=i.done}catch(s){r.error(s);return}a?r.complete():r.next(o)},0,!0)}),function(){return L(n==null?void 0:n.return)&&n.return()}})}function Qr(e,t){if(!e)throw new Error("Iterable cannot be null");return new B(function(r){oe(r,t,function(){var n=e[Symbol.asyncIterator]();oe(r,t,function(){n.next().then(function(i){i.done?r.complete():r.next(i.value)})},0,!0)})})}function ea(e,t){return Qr(Wr(e),t)}function ta(e,t){if(e!=null){if($r(e))return Xo(e,t);if(mt(e))return Qo(e,t);if(jr(e))return Jo(e,t);if(Gr(e))return Qr(e,t);if(Kr(e))return Zo(e,t);if(zr(e))return ea(e,t)}throw Br(e)}function ra(e,t){return t?ta(e,t):X(e)}function Zr(e){return e instanceof Date&&!isNaN(e)}var na=vt(function(e){return function(r){r===void 0&&(r=null),e(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=r}});function ia(e,t){var r=Zr(e)?{first:e}:typeof e=="number"?{each:e}:e,n=r.first,i=r.each,o=r.with,a=o===void 0?oa:o,s=r.scheduler,u=s===void 0?Me:s,c=r.meta,l=c===void 0?null:c;if(n==null&&i==null)throw new TypeError("No timeout provided.");return Z(function(d,f){var v,h,y=null,_=0,p=function(g){h=oe(f,u,function(){try{v.unsubscribe(),X(a({meta:l,lastValue:y,seen:_})).subscribe(f)}catch(E){f.error(E)}},g)};v=d.subscribe(Y(f,function(g){h==null||h.unsubscribe(),_++,f.next(y=g),i>0&&p(i)},void 0,void 0,function(){h!=null&&h.closed||h==null||h.unsubscribe(),y=null})),!_&&p(n!=null?typeof n=="number"?n:+n-u.now():i)})}function oa(e){throw new na(e)}function Q(e,t){return Z(function(r,n){var i=0;r.subscribe(Y(n,function(o){n.next(e.call(t,o,i++))}))})}var aa=Array.isArray;function sa(e,t){return aa(t)?e.apply(void 0,D([],k(t))):e(t)}function ua(e){return Q(function(t){return sa(e,t)})}function ca(e,t,r,n,i,o,a,s){var u=[],c=0,l=0,d=!1,f=function(){d&&!u.length&&!c&&t.complete()},v=function(y){return c<n?h(y):u.push(y)},h=function(y){c++;var _=!1;X(r(y,l++)).subscribe(Y(t,function(p){t.next(p)},function(){_=!0},void 0,function(){if(_)try{c--;for(var p=function(){var g=u.shift();a||h(g)};u.length&&c<n;)p();f()}catch(g){t.error(g)}}))};return e.subscribe(Y(t,v,function(){d=!0,f()})),function(){}}function Fe(e,t,r){return r===void 0&&(r=1/0),L(t)?Fe(function(n,i){return Q(function(o,a){return t(n,o,i,a)})(X(e(n,i)))},r):(typeof t=="number"&&(r=t),Z(function(n,i){return ca(n,i,e,r)}))}function la(e){return e===void 0&&(e=1/0),Fe(Mr,e)}var da=["addListener","removeListener"],fa=["addEventListener","removeEventListener"],va=["on","off"];function ge(e,t,r,n){if(L(r)&&(n=r,r=void 0),n)return ge(e,t,r).pipe(ua(n));var i=k(ga(e)?fa.map(function(s){return function(u){return e[s](t,u,r)}}):ha(e)?da.map(tr(e,t)):pa(e)?va.map(tr(e,t)):[],2),o=i[0],a=i[1];if(!o&&mt(e))return Fe(function(s){return ge(s,t,r)})(X(e));if(!o)throw new TypeError("Invalid event target");return new B(function(s){var u=function(){for(var c=[],l=0;l<arguments.length;l++)c[l]=arguments[l];return s.next(1<c.length?c:c[0])};return o(u),function(){return a(u)}})}function tr(e,t){return function(r){return function(n){return e[r](t,n)}}}function ha(e){return L(e.addListener)&&L(e.removeListener)}function pa(e){return L(e.on)&&L(e.off)}function ga(e){return L(e.addEventListener)&&L(e.removeEventListener)}function ma(e,t,r){r===void 0&&(r=Vo);var n=-1;return t!=null&&(qr(t)?r=t:n=t),new B(function(i){var o=Zr(e)?0-r.now():e;o<0&&(o=0);var a=0;return r.schedule(function(){i.closed||(i.next(a++),0<=n?this.schedule(void 0,n):i.complete())},o)})}function en(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=jo(e),n=$o(e,1/0),i=e;return i.length?i.length===1?X(i[0]):la(n)(ra(i,r)):gt}function ie(e,t){return Z(function(r,n){var i=0;r.subscribe(Y(n,function(o){return e.call(t,o,i++)&&n.next(o)}))})}function ya(e){return Z(function(t,r){var n=[];return t.subscribe(Y(r,function(i){return n.push(i)},function(){r.next(n),r.complete()})),X(e).subscribe(Y(r,function(){var i=n;n=[],r.next(i)},ut)),function(){n=null}})}function ba(e,t){return t===void 0&&(t=Me),Z(function(r,n){var i=null,o=null,a=null,s=function(){if(i){i.unsubscribe(),i=null;var c=o;o=null,n.next(c)}};function u(){var c=a+e,l=t.now();if(l<c){i=this.schedule(void 0,c-l),n.add(i);return}s()}r.subscribe(Y(n,function(c){o=c,a=t.now(),i||(i=t.schedule(u,e),n.add(i))},function(){s(),n.complete()},void 0,function(){o=i=null}))})}function tn(e){return e<=0?function(){return gt}:Z(function(t,r){var n=0;t.subscribe(Y(r,function(i){++n<=e&&(r.next(i),e<=n&&r.complete())}))})}function Ea(e){return Q(function(){return e})}function _a(e,t){return Fe(function(r,n){return X(e(r,n)).pipe(tn(1),Ea(r))})}function Ta(e,t){t===void 0&&(t=Me);var r=ma(e,t);return _a(function(){return r})}function wa(){return Z(function(e,t){var r,n=!1;e.subscribe(Y(t,function(i){var o=r;r=i,n&&t.next([o,i]),n=!0}))})}function we(e){e===void 0&&(e={});var t=e.connector,r=t===void 0?function(){return new Fr}:t,n=e.resetOnError,i=n===void 0?!0:n,o=e.resetOnComplete,a=o===void 0?!0:o,s=e.resetOnRefCountZero,u=s===void 0?!0:s;return function(c){var l,d,f,v=0,h=!1,y=!1,_=function(){d==null||d.unsubscribe(),d=void 0},p=function(){_(),l=f=void 0,h=y=!1},g=function(){var E=l;p(),E==null||E.unsubscribe()};return Z(function(E,S){v++,!y&&!h&&_();var I=f=f??r();S.add(function(){v--,v===0&&!y&&!h&&(d=tt(g,u))}),I.subscribe(S),!l&&v>0&&(l=new pe({next:function(w){return I.next(w)},error:function(w){y=!0,_(),d=tt(p,i,w),I.error(w)},complete:function(){h=!0,_(),d=tt(p,a),I.complete()}}),X(E).subscribe(l))})(c)}}function tt(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(t===!0){e();return}if(t!==!1){var i=new pe({next:function(){i.unsubscribe(),e()}});return X(t.apply(void 0,D([],k(r)))).subscribe(i)}}function Sa(e,t){return Z(function(r,n){var i=null,o=0,a=!1,s=function(){return a&&!i&&n.complete()};r.subscribe(Y(n,function(u){i==null||i.unsubscribe();var c=0,l=o++;X(e(u,l)).subscribe(i=Y(n,function(d){return n.next(t?t(u,d,l,c++):d)},function(){i=null,s()}))},function(){a=!0,s()}))})}var Ia=["id","class","style","value","onclick","onchange","oninput","onblur","onsubmit","onfocus","onkeydown","onkeyup","onkeypress","data-reactid","data-react-checksum","data-reactroot"],Aa=["type"],ka=["svg","path","g"],Pa=["password","hidden"],Ra=128,Ca=1024;function Oa(e){var t,r,n,i,o,a;if(e===null)return null;var s=String(e.tagName).toLowerCase(),u={tag:s},c=Array.from((i=(n=e.parentElement)===null||n===void 0?void 0:n.children)!==null&&i!==void 0?i:[]);c.length&&(u.index=c.indexOf(e),u.indexOfType=c.filter(function(S){return S.tagName===e.tagName}).indexOf(e));var l=(a=(o=e.previousElementSibling)===null||o===void 0?void 0:o.tagName)===null||a===void 0?void 0:a.toLowerCase();l&&(u.prevSib=String(l));var d=e.getAttribute("id");d&&(u.id=String(d));var f=Array.from(e.classList);f.length&&(u.classes=f);var v={},h=Array.from(e.attributes),y=h.filter(function(S){return!Ia.includes(S.name)}),_=!on(e);if(!Pa.includes(String(e.getAttribute("type")))&&!ka.includes(s))try{for(var p=x(y),g=p.next();!g.done;g=p.next()){var E=g.value;_&&!Aa.includes(E.name)||(v[E.name]=String(E.value).substring(0,Ra))}}catch(S){t={error:S}}finally{try{g&&!g.done&&(r=p.return)&&r.call(p)}finally{if(t)throw t.error}}return Object.keys(v).length&&(u.attrs=v),u}function La(e){var t=[];if(!e)return t;t.push(e);for(var r=e.parentElement;r&&r.tagName!=="HTML";)t.push(r),r=r.parentElement;return t}var Na=function(e){var t=[];if(!e)return[];var r=La(e);return t=xa(r.map(function(n){return Oa(n)}),Ca),t};function xa(e,t){for(var r=0,n=0;n<e.length;n++){var i=e[n];if(i===null)r+=4;else{var o=ke(i);r+=o?Array.from(o).length:4}if(r>t)return e.slice(0,n)}return e}function ke(e,t){t===void 0&&(t=!1);try{if(e==null)return t?"None":null;if(typeof e=="string")return t?(e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r"),e.includes('"')?"'".concat(e,"'"):e.includes("'")?'"'.concat(e.replace(/'/g,"\\'"),'"'):"'".concat(e,"'")):e;if(typeof e=="boolean")return e?"True":"False";if(Array.isArray(e)){var r=e.map(function(o){return ke(o,!0)});return"[".concat(r.join(", "),"]")}else if(typeof e=="object"){var n=Object.entries(e).filter(function(o){var a=k(o,1),s=a[0];return s!=null}).map(function(o){var a=k(o,2),s=a[0],u=a[1];return"".concat(String(ke(s,!0)),": ").concat(String(ke(u,!0)))}),i="{".concat(n.join(", "),"}");return i.includes("\\'")&&(i=i.replace(/'/g,"'").replace(/'/g,"\\'")),i}return e.toString()}catch{return null}}var Da=["input","select","textarea"],rn=function(e,t){var r,n=(r=window==null?void 0:window.getComputedStyle)===null||r===void 0?void 0:r.call(window,e);return(n==null?void 0:n.getPropertyValue("cursor"))==="pointer"&&t==="click"},rt=function(e,t,r){return r===void 0&&(r=!1),function(n,i){var o,a,s=e.pageUrlAllowlist,u=e.shouldTrackEventResolver,c=(a=(o=i==null?void 0:i.tagName)===null||o===void 0?void 0:o.toLowerCase)===null||a===void 0?void 0:a.call(o);if(!c)return!1;if(u)return u(n,i);if(!Ma(window.location.href,s))return!1;var l=String(i==null?void 0:i.getAttribute("type"))||"";if(typeof l=="string")switch(l.toLowerCase()){case"hidden":return!1;case"password":return!1}var d=rn(i,n);if(r&&d)return!0;if(t){var f=t.some(function(v){var h;return!!(!((h=i==null?void 0:i.matches)===null||h===void 0)&&h.call(i,v))});if(!f)return!1}switch(c){case"input":case"select":case"textarea":return n==="change"||n==="click";default:return d?!0:n==="click"}}},nn=function(e){if(e==null)return!1;if(typeof e=="string"){var t=/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/;if(t.test((e||"").replace(/[- ]/g,"")))return!1;var r=/(^\d{3}-?\d{2}-?\d{4}$)/;if(r.test(e))return!1}return!0},Ua=function(e){return!!e&&e.nodeType===3},on=function(e){var t,r,n,i=(r=(t=e==null?void 0:e.tagName)===null||t===void 0?void 0:t.toLowerCase)===null||r===void 0?void 0:r.call(t),o=e instanceof HTMLElement?((n=e.getAttribute("contenteditable"))===null||n===void 0?void 0:n.toLowerCase())==="true":!1;return!Da.includes(i)&&!o},yt=function(e){var t="";return on(e)&&e.childNodes&&e.childNodes.length&&e.childNodes.forEach(function(r){var n="";Ua(r)?r.textContent&&(n=r.textContent):n=yt(r),t+=n.split(/(\s+)/).filter(nn).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}),t},Ma=function(e,t){return!t||!t.length?!0:t.some(function(r){return typeof r=="string"?e===r:e.match(r)})},Fa=function(e,t){return e.getAttributeNames().reduce(function(r,n){if(n.startsWith(t)){var i=n.replace(t,""),o=e.getAttribute(n);i&&(r[i]=o||"")}return r},{})},qa=function(e){return e==null||typeof e=="object"&&Object.keys(e).length===0||typeof e=="string"&&e.trim().length===0},an=function(e){return Object.keys(e).reduce(function(t,r){var n=e[r];return qa(n)||(t[r]=n),t},{})},sn=function(e){var t=e.parentElement;if(!t)return"";var r;try{r=t.querySelector(":scope>span,h1,h2,h3,h4,h5,h6")}catch{r=null}if(r){var n=r.textContent||"";return nn(n)?n:""}return sn(t)},bt=function(e,t){return e?t.some(function(r){var n;return(n=e==null?void 0:e.matches)===null||n===void 0?void 0:n.call(e,r)})?e:bt(e==null?void 0:e.parentElement,t):null},Va=function(e){var t,r,n;if(!e)return{};var i=(n=(r=e==null?void 0:e.tagName)===null||r===void 0?void 0:r.toLowerCase)===null||n===void 0?void 0:n.call(r),o=(t={},t[Or]=i,t[Lr]=yt(e),t[Nr]=window.location.href.split("?")[0],t);return an(o)},ja=function(e){return new Promise(function(t,r){var n;try{var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.src=e,i.addEventListener("load",function(){t({status:!0})},{once:!0}),i.addEventListener("error",function(){r({status:!1,message:"Failed to load the script ".concat(e)})}),(n=document.head)===null||n===void 0||n.appendChild(i)}catch(o){r(o)}})};function $a(){return"".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9))}var Et=function(e){return!(e.event.target===null||!e.closestTrackedAncestor)},Ue=function(e,t,r){var n,i,o,a=(o=(i=t==null?void 0:t.tagName)===null||i===void 0?void 0:i.toLowerCase)===null||o===void 0?void 0:o.call(i),s=typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{left:null,top:null},u=t.getAttribute("aria-label"),c=Fa(t,r),l=sn(t),d=(n={},n[so]=t.getAttribute("id")||"",n[uo]=t.getAttribute("class"),n[co]=Na(t),n[Or]=a,n[Lr]=yt(t),n[fo]=s.left==null?null:Math.round(s.left),n[vo]=s.top==null?null:Math.round(s.top),n[ho]=u,n[po]=c,n[go]=l,n[Nr]=window.location.href.split("?")[0],n[mo]=typeof document<"u"&&document.title||"",n[yo]=window.innerHeight,n[bo]=window.innerWidth,n);return a==="a"&&e==="click"&&t instanceof HTMLAnchorElement&&(d[lo]=t.href),an(d)},Se=function(e,t,r,n,i){i===void 0&&(i=!1);var o={event:e,timestamp:Date.now(),type:t};if(Ga(o)&&o.event.target!==null){if(i){var a=rn(o.event.target,o.type);if(a)return o.closestTrackedAncestor=o.event.target,o.targetElementProperties=Ue(o.type,o.closestTrackedAncestor,n),o}var s=bt(o.event.target,r);return s&&(o.closestTrackedAncestor=s,o.targetElementProperties=Ue(o.type,s,n)),o}return o};function Ga(e){return e.type==="click"||e.type==="change"}var Ba=function(){function e(t){var r=t===void 0?{}:t,n=r.origin,i=n===void 0?Ie:n,o=this;this.endpoint=Ie,this.requestCallbacks={},this.onSelect=function(a){o.notify({action:"element-selected",data:a})},this.onTrack=function(a,s){a==="selector-mode-changed"?o.notify({action:"track-selector-mode-changed",data:s}):a==="selector-moved"&&o.notify({action:"track-selector-moved",data:s})},this.endpoint=i}return e.prototype.notify=function(t){var r,n,i,o;(n=(r=this.logger)===null||r===void 0?void 0:r.debug)===null||n===void 0||n.call(r,"Message sent: ",JSON.stringify(t)),(o=(i=window.opener)===null||i===void 0?void 0:i.postMessage)===null||o===void 0||o.call(i,t,this.endpoint)},e.prototype.sendRequest=function(t,r,n){var i=this;n===void 0&&(n={timeout:15e3});var o=$a(),a={id:o,action:t,args:r},s=new Promise(function(u,c){i.requestCallbacks[o]={resolve:u,reject:c},i.notify(a),(n==null?void 0:n.timeout)>0&&setTimeout(function(){c(new Error("".concat(t," timed out (id: ").concat(o,")"))),delete i.requestCallbacks[o]},n.timeout)});return s},e.prototype.handleResponse=function(t){var r;if(!this.requestCallbacks[t.id]){(r=this.logger)===null||r===void 0||r.warn("No callback found for request id: ".concat(t.id));return}this.requestCallbacks[t.id].resolve(t.responseData),delete this.requestCallbacks[t.id]},e.prototype.setup=function(t){var r=this,n=t===void 0?{}:t,i=n.logger,o=n.endpoint,a=n.isElementSelectable,s=n.cssSelectorAllowlist,u=n.actionClickAllowlist;this.logger=i,o&&this.endpoint===Ie&&(this.endpoint=o);var c=null;window.addEventListener("message",function(l){var d,f,v,h,y;if((f=(d=r.logger)===null||d===void 0?void 0:d.debug)===null||f===void 0||f.call(d,"Message received: ",JSON.stringify(l)),r.endpoint===l.origin){var _=l==null?void 0:l.data,p=_==null?void 0:_.action;if(p)if("id"in _)(h=(v=r.logger)===null||v===void 0?void 0:v.debug)===null||h===void 0||h.call(v,"Received Response to previous request: ",JSON.stringify(l)),r.handleResponse(_);else if(p==="ping")r.notify({action:"pong"});else if(p==="initialize-visual-tagging-selector"){var g=_==null?void 0:_.data;ja(wo).then(function(){var E;c=(E=window==null?void 0:window.amplitudeVisualTaggingSelector)===null||E===void 0?void 0:E.call(window,{getEventTagProps:Va,isElementSelectable:function(S){return a?a((g==null?void 0:g.actionType)||"click",S):!0},onTrack:r.onTrack,onSelect:r.onSelect,visualHighlightClass:So,messenger:r,cssSelectorAllowlist:s,actionClickAllowlist:u}),r.notify({action:"selector-loaded"})}).catch(function(){var E;(E=r.logger)===null||E===void 0||E.warn("Failed to initialize visual tagging selector")})}else p==="close-visual-tagging-selector"&&((y=c==null?void 0:c.close)===null||y===void 0||y.call(c))}}),this.notify({action:"page-loaded"})},e}(),Ha=5;function Ka(e){var t=e.amplitude,r=e.allObservables,n=e.options,i=e.shouldTrackEvent,o=e.evaluateTriggers,a=r.clickObservable,s=a.pipe(wa(),ie(function(d){var f=k(d,2),v=f[0],h=f[1],y=v.event.target!==h.event.target,_=Math.abs(h.event.screenX-v.event.screenX)<=20&&Math.abs(h.event.screenY-v.event.screenY)<=20;return y&&!_})),u=a.pipe(ba(n.debounceTime),Q(function(){return"timeout"})),c=en(s,u),l=a.pipe(Ta(0),ie(Et),ie(function(d){return i("click",d.closestTrackedAncestor)}),Q(function(d){return o(d)}),ya(c));return l.subscribe(function(d){var f,v,h=(d.length>=Ha,st);try{for(var y=x(d),_=y.next();!_.done;_=y.next()){var p=_.value;t==null||t.track(h,p.targetElementProperties)}}catch(g){f={error:g}}finally{try{_&&!_.done&&(v=y.return)&&v.call(y)}finally{if(f)throw f.error}}})}function Wa(e){var t=e.amplitude,r=e.allObservables,n=e.getEventProperties,i=e.shouldTrackEvent,o=e.evaluateTriggers,a=r.changeObservable,s=a.pipe(ie(Et),ie(function(u){return i("change",u.closestTrackedAncestor)}),Q(function(u){return o(u)}));return s.subscribe(function(u){t==null||t.track(ao,n("change",u.closestTrackedAncestor))})}function za(e){var t=e.amplitude,r=e.allObservables,n=e.options,i=e.getEventProperties,o=e.shouldTrackEvent,a=e.shouldTrackActionClick,s=r.clickObservable,u=r.mutationObservable,c=r.navigateObservable,l=s.pipe(ie(function(h){return!o("click",h.closestTrackedAncestor)}),Q(function(h){var y=bt(h.event.target,n.actionClickAllowlist);return h.closestTrackedAncestor=y,h.closestTrackedAncestor!==null&&(h.targetElementProperties=i(h.type,h.closestTrackedAncestor)),h}),ie(Et),ie(function(h){return a("click",h.closestTrackedAncestor)})),d=[u];c&&d.push(c);var f=en.apply(void 0,D([],k(d),!1)),v=l.pipe(Sa(function(h){return f.pipe(tn(1),ia({first:500,with:function(){return gt}}),Q(function(){return h}))}));return v.subscribe(function(h){t==null||t.track(st,i("click",h.closestTrackedAncestor))})}var Ya=function(){return new B(function(e){var t=new MutationObserver(function(r){e.next(r)});return t.observe(document.body,{childList:!0,attributes:!0,characterData:!0,subtree:!0}),function(){return t.disconnect()}})},Xa=function(){return ge(document,"click",{capture:!0})},Ja=function(e,t){try{if(t.subprop_key==="[Amplitude] Element Text")return t.subprop_op==="exact"&&t.subprop_value.includes(e.targetElementProperties["[Amplitude] Element Text"]);if(t.subprop_key==="[Amplitude] Element Hierarchy")return t.subprop_op==="autotrack css match"&&!!e.closestTrackedAncestor.closest(t.subprop_value.toString())}catch(r){return console.error("Error matching event to filter",r),!1}return!1},Qa=function(e){var t,r,n,i,o,a={click:new Set,change:new Set};if(!e)return a;try{for(var s=x(e),u=s.next();!u.done;u=s.next()){var c=u.value;try{try{for(var l=(n=void 0,x(c.definition)),d=l.next();!d.done;d=l.next()){var f=d.value;(o=a[f.event_type])===null||o===void 0||o.add(c.id)}}catch(v){n={error:v}}finally{try{d&&!d.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}}catch(v){console.warn("Skipping Labeled Event due to malformed definition",c==null?void 0:c.id,v)}}}catch(v){t={error:v}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return a},Za=function(e){var t,r,n,i,o=new Map;try{for(var a=x(e),s=a.next();!s.done;s=a.next()){var u=s.value;try{for(var c=(n=void 0,x(u.conditions)),l=c.next();!l.done;l=c.next()){var d=l.value;if(d.type==="LABELED_EVENT"){var f=d.match.eventId,v=o.get(f);v||(v=[],o.set(f,v)),v.push(u)}}}catch(h){n={error:h}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(n)throw n.error}}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return o},es=function(e,t){return t.filter(function(r){return r.definition.some(function(n){return n.event_type===e.type&&n.filters.every(function(i){return Ja(e,i)})})})},ts=function(e,t){var r,n,i=new Set;try{for(var o=x(e),a=o.next();!a.done;a=o.next()){var s=a.value,u=t.get(s.id);u&&u.forEach(function(c){return i.add(c)})}}catch(c){r={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return Array.from(i)},rs=function(e,t){if(e.sourceType==="DOM_ELEMENT"){var r=document.documentElement;return e.scope&&t&&(r=t.closest(e.scope)),r&&e.selector?r.querySelector(e.selector):r}},ns=function(e,t){if(e.sourceType==="DOM_ELEMENT"){var r=rs(e,t);return r?e.elementExtractType==="TEXT"?r.textContent:e.elementExtractType==="ATTRIBUTE"&&e.attribute?r.getAttribute(e.attribute):void 0:void 0}},is=function(e,t){e.forEach(function(r){if(typeof r!="string"&&r.actionType==="ATTACH_EVENT_PROPERTY"){var n=ns(r.dataSource,t.closestTrackedAncestor);t.targetElementProperties[r.destinationKey]=n}})},ve;(function(e){e.ClickObservable="clickObservable",e.ChangeObservable="changeObservable",e.NavigateObservable="navigateObservable",e.MutationObservable="mutationObservable"})(ve||(ve={}));var os=function(e){var t,r,n,i,o,a,s;e===void 0&&(e={});var u=e.dataAttributePrefix,c=u===void 0?zn:u,l=e.visualTaggingOptions,d=l===void 0?{enabled:!0,messenger:new Ba}:l;e.cssSelectorAllowlist=(t=e.cssSelectorAllowlist)!==null&&t!==void 0?t:Wn,e.actionClickAllowlist=(r=e.actionClickAllowlist)!==null&&r!==void 0?r:Yn,e.debounceTime=(n=e.debounceTime)!==null&&n!==void 0?n:0;var f=oo,v="enrichment",h=[],y=function(){var w,P=Xa().pipe(Q(function(N){return Se(N,"click",e.cssSelectorAllowlist,c)}),we()),C=ge(document,"change",{capture:!0}).pipe(Q(function(N){return Se(N,"change",e.cssSelectorAllowlist,c)}),we()),R;window.navigation&&(R=ge(window.navigation,"navigate").pipe(Q(function(N){return Se(N,"navigate",e.cssSelectorAllowlist,c)}),we()));var U=Ya().pipe(Q(function(N){return Se(N,"mutation",e.cssSelectorAllowlist,c)}),we());return w={},w[ve.ClickObservable]=P,w[ve.ChangeObservable]=C,w[ve.NavigateObservable]=R,w[ve.MutationObservable]=U,w},_=Qa(Object.values((o=(i=e.pageActions)===null||i===void 0?void 0:i.labeledEvents)!==null&&o!==void 0?o:{})),p=Za((s=(a=e.pageActions)===null||a===void 0?void 0:a.triggers)!==null&&s!==void 0?s:[]),g=function(w){var P,C,R=e.pageActions;if(!R)return w;var U=es(w,Array.from(_[w.type]).map(function(H){return R.labeledEvents[H]})),N=ts(U,p);try{for(var M=x(N),j=M.next();!j.done;j=M.next()){var K=j.value;is(K.actions,w)}}catch(H){P={error:H}}finally{try{j&&!j.done&&(C=M.return)&&C.call(M)}finally{if(P)throw P.error}}return w},E=function(w,P){return b(void 0,void 0,void 0,function(){var C,R,U,N,M,j,K,H,ee,ne;return m(this,function(ce){return typeof document>"u"?[2]:(C=rt(e,e.cssSelectorAllowlist),R=rt(e,e.actionClickAllowlist),U=y(),N=Ka({allObservables:U,options:e,amplitude:P,shouldTrackEvent:C,evaluateTriggers:g}),h.push(N),M=Wa({allObservables:U,getEventProperties:function(){for(var J=[],$=0;$<arguments.length;$++)J[$]=arguments[$];return Ue.apply(void 0,D(D([],k(J),!1),[c],!1))},amplitude:P,shouldTrackEvent:C,evaluateTriggers:g}),h.push(M),j=za({allObservables:U,options:e,getEventProperties:function(){for(var J=[],$=0;$<arguments.length;$++)J[$]=arguments[$];return Ue.apply(void 0,D(D([],k(J),!1),[c],!1))},amplitude:P,shouldTrackEvent:C,shouldTrackActionClick:R}),h.push(j),(ee=w==null?void 0:w.loggerProvider)===null||ee===void 0||ee.log("".concat(f," has been successfully added.")),window.opener&&d.enabled&&(K=e.cssSelectorAllowlist,H=e.actionClickAllowlist,(ne=d.messenger)===null||ne===void 0||ne.setup(T(T({logger:w==null?void 0:w.loggerProvider},(w==null?void 0:w.serverZone)&&{endpoint:To[w.serverZone]}),{isElementSelectable:rt(e,D(D([],k(K),!1),k(H),!1)),cssSelectorAllowlist:K,actionClickAllowlist:H}))),[2])})})},S=function(w){return b(void 0,void 0,void 0,function(){return m(this,function(P){return[2,w]})})},I=function(){return b(void 0,void 0,void 0,function(){var w,P,C,R,U;return m(this,function(N){try{for(w=x(h),P=w.next();!P.done;P=w.next())C=P.value,C.unsubscribe()}catch(M){R={error:M}}finally{try{P&&!P.done&&(U=w.return)&&U.call(w)}finally{if(R)throw R.error}}return[2]})})};return{name:f,type:v,setup:E,execute:S,teardown:I}},as="@amplitude/plugin-network-capture-browser",ss="[Amplitude] Network Request",un="500-599";function Pe(e,t){var r=t.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&"),n="^"+r.replace(/\*/g,".*")+"$",i=new RegExp(n);return i.test(e)}function cn(e,t){var r,n,i=t.split(",");try{for(var o=x(i),a=o.next();!a.done;a=o.next()){var s=a.value,u=k(s.split("-").map(Number),2),c=u[0],l=u[1];if(e===c&&l===void 0||e>=c&&e<=l)return!0}}catch(d){r={error:d}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}function us(e,t,r){if(!(e.hosts&&!e.hosts.find(function(i){return Pe(t,i)}))){if(r||r===0){var n=e.statusCodeRange||un;if(!cn(r,n))return!1}return!0}}function ln(e){var t;if(e)try{var r=(t=G())===null||t===void 0?void 0:t.location.href,n=new URL(e,r),i=n.searchParams.toString(),o=n.hash.replace("#",""),a=n.href,s=n.host;n.hash="",n.search="";var u=n.href;return{query:i,fragment:o,href:a,hrefWithoutQueryOrHash:u,host:s}}catch{return}}function cs(e,t){var r;t===void 0&&(t={});var n=ln(e.url);if(!n)return!1;var i=n.host;if(t.ignoreAmplitudeRequests!==!1&&(Pe(i,"*.amplitude.com")||Pe(i,"amplitude.com"))||!((r=t.ignoreHosts)===null||r===void 0)&&r.find(function(a){return Pe(i,a)})||!t.captureRules&&e.status!==void 0&&!cn(e.status,un))return!1;if(t.captureRules){var o;if(D([],k(t.captureRules),!1).reverse().find(function(a){return o=us(a,i,e.status),o!==void 0}),!o)return!1}return!0}function ls(e){var t=e.allObservables,r=e.networkTrackingOptions,n=e.amplitude,i=t.networkObservable,o=i.pipe(ie(function(a){return cs(a.event,r)}));return o.subscribe(function(a){var s,u,c,l=a.event,d=ln(l.url);if(d){var f=(u=l.responseWrapper)===null||u===void 0?void 0:u.bodySize,v=(c=l.requestWrapper)===null||c===void 0?void 0:c.bodySize,h=(s={},s["[Amplitude] URL"]=d.hrefWithoutQueryOrHash,s["[Amplitude] URL Query"]=d.query,s["[Amplitude] URL Fragment"]=d.fragment,s["[Amplitude] Request Method"]=l.method,s["[Amplitude] Status Code"]=l.status,s["[Amplitude] Start Time"]=l.startTime,s["[Amplitude] Completion Time"]=l.endTime,s["[Amplitude] Duration"]=l.duration,s["[Amplitude] Request Body Size"]=v,s["[Amplitude] Response Body Size"]=f,s["[Amplitude] Request Type"]=l.type,s);n==null||n.track(ss,h)}})}var ct;(function(e){e.NetworkObservable="networkObservable"})(ct||(ct={}));var ds=function(e){e===void 0&&(e={});var t=as,r="enrichment",n,i=[],o=function(l,d){var f={event:l,timestamp:Date.now(),type:d};return f},a=function(){var l,d=new B(function(f){var v=new ri(function(h){var y=o(h,"network");f.next(y)});return At.subscribe(v,n),function(){At.unsubscribe(v)}});return l={},l[ct.NetworkObservable]=d,l},s=function(l,d){return b(void 0,void 0,void 0,function(){var f,v;return m(this,function(h){return typeof document>"u"?[2]:(f=a(),v=ls({allObservables:f,networkTrackingOptions:e,amplitude:d}),i.push(v),n=l==null?void 0:l.loggerProvider,n==null||n.log("".concat(t," has been successfully added.")),[2])})})},u=function(l){return b(void 0,void 0,void 0,function(){return m(this,function(d){return[2,l]})})},c=function(){return b(void 0,void 0,void 0,function(){var l,d,f,v,h;return m(this,function(y){try{for(l=x(i),d=l.next();!d.done;d=l.next())f=d.value,f.unsubscribe()}catch(_){v={error:_}}finally{try{d&&!d.done&&(h=l.return)&&h.call(l)}finally{if(v)throw v.error}}return[2]})})};return{name:t,type:r,setup:s,execute:u,teardown:c}},fs="utm_campaign",vs="utm_content",hs="utm_id",ps="utm_medium",gs="utm_source",ms="utm_term",rr="dclid",nr="fbclid",ir="gbraid",or="gclid",ar="ko_click_id",sr="li_fat_id",ur="msclkid",cr="rtd_cid",lr="ttclid",dr="twclid",fr="wbraid",_t={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,referrer:void 0,referring_domain:void 0,dclid:void 0,gbraid:void 0,gclid:void 0,fbclid:void 0,ko_click_id:void 0,li_fat_id:void 0,msclkid:void 0,rtd_cid:void 0,ttclid:void 0,twclid:void 0,wbraid:void 0},vr=function(e){var t=e.split(".");return t.length<=2?e:t.slice(t.length-2,t.length).join(".")},ys=function(e){return Object.values(e).every(function(t){return!t})},bs=function(e,t,r,n,i){i===void 0&&(i=!0),e.referrer;var o=e.referring_domain,a=nt(e,["referrer","referring_domain"]),s=t||{};s.referrer;var u=s.referring_domain,c=nt(s,["referrer","referring_domain"]);if(Es(r.excludeReferrers,e.referring_domain))return n.debug("This is not a new campaign because ".concat(e.referring_domain," is in the exclude referrer list.")),!1;if(!i&&ys(e)&&t)return n.debug("This is not a new campaign because this is a direct traffic in the same session."),!1;var l=JSON.stringify(a)!==JSON.stringify(c),d=vr(o||"")!==vr(u||""),f=!t||l||d;return f?n.debug("This is a new campaign. An $identify event will be sent."):n.debug("This is not a new campaign because it's the same as the previous one."),f},Es=function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=""),e.some(function(r){return r instanceof RegExp?r.test(t):r===t})},_s=function(e,t){var r=T(T({},_t),e),n=Object.entries(r).reduce(function(i,o){var a,s=k(o,2),u=s[0],c=s[1];return i.setOnce("initial_".concat(u),(a=c??t.initialEmptyValue)!==null&&a!==void 0?a:"EMPTY"),c?i.set(u,c):i.unset(u)},new Re);return gr(n)},Ts=function(e){var t=e;return t?(t.startsWith(".")&&(t=t.substring(1)),[new RegExp("".concat(t.replace(".","\\."),"$"))]):[]},ws=function(){function e(){}return e.prototype.parse=function(){return b(this,void 0,void 0,function(){return m(this,function(t){return[2,T(T(T(T({},_t),this.getUtmParam()),this.getReferrer()),this.getClickIds())]})})},e.prototype.getUtmParam=function(){var t=Ce(),r=t[fs],n=t[vs],i=t[hs],o=t[ps],a=t[gs],s=t[ms];return{utm_campaign:r,utm_content:n,utm_id:i,utm_medium:o,utm_source:a,utm_term:s}},e.prototype.getReferrer=function(){var t,r,n={referrer:void 0,referring_domain:void 0};try{n.referrer=document.referrer||void 0,n.referring_domain=(r=(t=n.referrer)===null||t===void 0?void 0:t.split("/")[2])!==null&&r!==void 0?r:void 0}catch{}return n},e.prototype.getClickIds=function(){var t,r=Ce();return t={},t[rr]=r[rr],t[nr]=r[nr],t[ir]=r[ir],t[or]=r[or],t[ar]=r[ar],t[sr]=r[sr],t[ur]=r[ur],t[cr]=r[cr],t[lr]=r[lr],t[dr]=r[dr],t[fr]=r[fr],t},e}(),Ss=function(){function e(t,r){var n;this.shouldTrackNewCampaign=!1,this.options=T({initialEmptyValue:"EMPTY",resetSessionOnNewCampaign:!1,excludeReferrers:Ts((n=r.cookieOptions)===null||n===void 0?void 0:n.domain)},t),this.storage=r.cookieStorage,this.storageKey=Hn(r.apiKey,"MKTG"),this.currentCampaign=_t,this.sessionTimeout=r.sessionTimeout,this.lastEventTime=r.lastEventTime,this.logger=r.loggerProvider,r.loggerProvider.log("Installing web attribution tracking.")}return e.prototype.init=function(){return b(this,void 0,void 0,function(){var t,r;return m(this,function(n){switch(n.label){case 0:return[4,this.fetchCampaign()];case 1:return r=k.apply(void 0,[n.sent(),2]),this.currentCampaign=r[0],this.previousCampaign=r[1],t=this.lastEventTime?mr(this.sessionTimeout,this.lastEventTime):!0,bs(this.currentCampaign,this.previousCampaign,this.options,this.logger,t)?(this.shouldTrackNewCampaign=!0,[4,this.storage.set(this.storageKey,this.currentCampaign)]):[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})},e.prototype.fetchCampaign=function(){return b(this,void 0,void 0,function(){return m(this,function(t){switch(t.label){case 0:return[4,Promise.all([new ws().parse(),this.storage.get(this.storageKey)])];case 1:return[2,t.sent()]}})})},e.prototype.generateCampaignEvent=function(t){this.shouldTrackNewCampaign=!1;var r=_s(this.currentCampaign,this.options);return t&&(r.event_id=t),r},e.prototype.shouldSetSessionIdOnNewCampaign=function(){return this.shouldTrackNewCampaign&&!!this.options.resetSessionOnNewCampaign},e}(),Is=function(e){z(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r,n,i){r===void 0&&(r="");var o,a;return arguments.length>2?(o=n,a=i):typeof n=="string"?(o=n,a=void 0):(o=n==null?void 0:n.userId,a=n),W(this._init(T(T({},a),{userId:o,apiKey:r})))},t.prototype._init=function(r){var n,i,o;return b(this,void 0,void 0,function(){var a,s,u,c,l,d,f=this;return m(this,function(v){switch(v.label){case 0:return this.initializing?[2]:(this.initializing=!0,[4,Pi(r.apiKey,r,this)]);case 1:return a=v.sent(),a.fetchRemoteConfig?[4,io(a)]:[3,4];case 2:return s=v.sent(),[4,s.generateJoinedConfig()];case 3:a=v.sent(),v.label=4;case 4:return[4,e.prototype._init.call(this,a)];case 5:return v.sent(),this.logBrowserOptions(a),_r(this.config.defaultTracking)?(u=ci(this.config),this.webAttribution=new Ss(u,this.config),[4,this.webAttribution.init()]):[3,7];case 6:v.sent(),v.label=7;case 7:return c=Ce(),l=Number.isNaN(Number(c.ampSessionId))?void 0:Number(c.ampSessionId),this.setSessionId((o=(i=(n=r.sessionId)!==null&&n!==void 0?n:l)!==null&&i!==void 0?i:this.config.sessionId)!==null&&o!==void 0?o:Date.now()),d=it(r.instanceName),d.identityStore.setIdentity({userId:this.config.userId,deviceId:this.config.deviceId}),this.config.offline===Kn?[3,9]:[4,this.add(Wi()).promise];case 8:v.sent(),v.label=9;case 9:return[4,this.add(new qn).promise];case 10:return v.sent(),[4,this.add(new vi).promise];case 11:return v.sent(),[4,this.add(new Vn).promise];case 12:return v.sent(),Ki(this.config),ii(this.config.defaultTracking)?(this.config.loggerProvider.debug("Adding file download tracking plugin"),[4,this.add(Hi()).promise]):[3,14];case 13:v.sent(),v.label=14;case 14:return oi(this.config.defaultTracking)?(this.config.loggerProvider.debug("Adding form interaction plugin"),[4,this.add(Bi()).promise]):[3,16];case 15:v.sent(),v.label=16;case 16:return Tr(this.config.defaultTracking)?(this.config.loggerProvider.debug("Adding page view tracking plugin"),[4,this.add(Vi(ui(this.config))).promise]):[3,18];case 17:v.sent(),v.label=18;case 18:return Sr(this.config.autocapture)?(this.config.loggerProvider.debug("Adding user interactions plugin (autocapture plugin)"),[4,this.add(os(ai(this.config))).promise]):[3,20];case 19:v.sent(),v.label=20;case 20:return wr(this.config.autocapture)?(this.config.loggerProvider.debug("Adding network tracking plugin"),[4,this.add(ds(si(this.config))).promise]):[3,22];case 21:v.sent(),v.label=22;case 22:return this.initializing=!1,[4,this.runQueuedFunctions("dispatchQ")];case 23:return v.sent(),d.eventBridge.setEventReceiver(function(h){f.track(h.eventType,h.eventProperties)}),[2]}})})},t.prototype.getUserId=function(){var r;return(r=this.config)===null||r===void 0?void 0:r.userId},t.prototype.setUserId=function(r){if(!this.config){this.q.push(this.setUserId.bind(this,r));return}this.config.loggerProvider.debug("function setUserId: ",r),(r!==this.config.userId||r===void 0)&&(this.config.userId=r,this.timeline.onIdentityChanged({userId:r}),yn(r,this.config.instanceName))},t.prototype.getDeviceId=function(){var r;return(r=this.config)===null||r===void 0?void 0:r.deviceId},t.prototype.setDeviceId=function(r){if(!this.config){this.q.push(this.setDeviceId.bind(this,r));return}this.config.loggerProvider.debug("function setDeviceId: ",r),r!==this.config.deviceId&&(this.config.deviceId=r,this.timeline.onIdentityChanged({deviceId:r}),bn(r,this.config.instanceName))},t.prototype.reset=function(){this.setDeviceId(ue()),this.setUserId(void 0)},t.prototype.getSessionId=function(){var r;return(r=this.config)===null||r===void 0?void 0:r.sessionId},t.prototype.setSessionId=function(r){var n,i=[];if(!this.config)return this.q.push(this.setSessionId.bind(this,r)),W(Promise.resolve());if(r===this.config.sessionId)return W(Promise.resolve());this.config.loggerProvider.debug("function setSessionId: ",r);var o=this.getSessionId();o!==r&&this.timeline.onSessionIdChanged(r);var a=this.config.lastEventTime,s=(n=this.config.lastEventId)!==null&&n!==void 0?n:-1;this.config.sessionId=r,this.config.lastEventTime=void 0,this.config.pageCounter=0,kt(this.config.defaultTracking)&&(o&&a&&i.push(this.track(Ct,void 0,{device_id:this.previousSessionDeviceId,event_id:++s,session_id:o,time:a+1,user_id:this.previousSessionUserId}).promise),this.config.lastEventTime=this.config.sessionId);var u=this.trackCampaignEventIfNeeded(++s,i);return kt(this.config.defaultTracking)&&i.push(this.track(Rt,void 0,{event_id:u?++s:s,session_id:this.config.sessionId,time:this.config.lastEventTime}).promise),this.previousSessionDeviceId=this.config.deviceId,this.previousSessionUserId=this.config.userId,W(Promise.all(i))},t.prototype.extendSession=function(){if(!this.config){this.q.push(this.extendSession.bind(this));return}this.config.lastEventTime=Date.now()},t.prototype.setTransport=function(r){if(!this.config){this.q.push(this.setTransport.bind(this,r));return}this.config.transportProvider=Pr(r)},t.prototype.identify=function(r,n){if(Ye(r)){var i=r._q;r._q=[],r=ze(new Re,i)}return n!=null&&n.user_id&&this.setUserId(n.user_id),n!=null&&n.device_id&&this.setDeviceId(n.device_id),e.prototype.identify.call(this,r,n)},t.prototype.groupIdentify=function(r,n,i,o){if(Ye(i)){var a=i._q;i._q=[],i=ze(new Re,a)}return e.prototype.groupIdentify.call(this,r,n,i,o)},t.prototype.revenue=function(r,n){if(Ye(r)){var i=r._q;r._q=[],r=ze(new Un,i)}return e.prototype.revenue.call(this,r,n)},t.prototype.trackCampaignEventIfNeeded=function(r,n){if(!this.webAttribution||!this.webAttribution.shouldTrackNewCampaign)return!1;var i=this.webAttribution.generateCampaignEvent(r);return n?n.push(this.track(i).promise):this.track(i),this.config.loggerProvider.log("Tracking attribution."),!0},t.prototype.process=function(r){return b(this,void 0,void 0,function(){var n,i,o;return m(this,function(a){return n=Date.now(),i=mr(this.config.sessionTimeout,this.config.lastEventTime),o=this.webAttribution&&this.webAttribution.shouldSetSessionIdOnNewCampaign(),r.event_type!==Rt&&r.event_type!==Ct&&(!r.session_id||r.session_id===this.getSessionId())&&(i||o?(this.setSessionId(n),o&&this.config.loggerProvider.log("Created a new session for new campaign.")):i||this.trackCampaignEventIfNeeded()),[2,e.prototype.process.call(this,r)]})})},t.prototype.logBrowserOptions=function(r){try{var n=T(T({},r),{apiKey:r.apiKey.substring(0,10)+"********"});this.config.loggerProvider.debug("Initialized Amplitude with BrowserConfig:",JSON.stringify(n))}catch(i){this.config.loggerProvider.error("Error logging browser config",i)}},t}(Dn),As=function(){var e=new Is;return{init:F(e.init.bind(e),"init",V(e),q(e,["config"])),add:F(e.add.bind(e),"add",V(e),q(e,["config.apiKey","timeline.plugins"])),remove:F(e.remove.bind(e),"remove",V(e),q(e,["config.apiKey","timeline.plugins"])),track:F(e.track.bind(e),"track",V(e),q(e,["config.apiKey","timeline.queue.length"])),logEvent:F(e.logEvent.bind(e),"logEvent",V(e),q(e,["config.apiKey","timeline.queue.length"])),identify:F(e.identify.bind(e),"identify",V(e),q(e,["config.apiKey","timeline.queue.length"])),groupIdentify:F(e.groupIdentify.bind(e),"groupIdentify",V(e),q(e,["config.apiKey","timeline.queue.length"])),setGroup:F(e.setGroup.bind(e),"setGroup",V(e),q(e,["config.apiKey","timeline.queue.length"])),revenue:F(e.revenue.bind(e),"revenue",V(e),q(e,["config.apiKey","timeline.queue.length"])),flush:F(e.flush.bind(e),"flush",V(e),q(e,["config.apiKey","timeline.queue.length"])),getUserId:F(e.getUserId.bind(e),"getUserId",V(e),q(e,["config","config.userId"])),setUserId:F(e.setUserId.bind(e),"setUserId",V(e),q(e,["config","config.userId"])),getDeviceId:F(e.getDeviceId.bind(e),"getDeviceId",V(e),q(e,["config","config.deviceId"])),setDeviceId:F(e.setDeviceId.bind(e),"setDeviceId",V(e),q(e,["config","config.deviceId"])),reset:F(e.reset.bind(e),"reset",V(e),q(e,["config","config.userId","config.deviceId"])),getSessionId:F(e.getSessionId.bind(e),"getSessionId",V(e),q(e,["config"])),setSessionId:F(e.setSessionId.bind(e),"setSessionId",V(e),q(e,["config"])),extendSession:F(e.extendSession.bind(e),"extendSession",V(e),q(e,["config"])),setOptOut:F(e.setOptOut.bind(e),"setOptOut",V(e),q(e,["config"])),setTransport:F(e.setTransport.bind(e),"setTransport",V(e),q(e,["config"]))}};const be=As();var Ls=be.add,Ns=be.identify,xs=be.init,Ds=be.setUserId,Us=be.track;export{Is as AmplitudeBrowser,Re as Identify,Un as Revenue,Ls as add,As as createInstance,Ns as identify,xs as init,Ds as setUserId,Us as track};
