import{a2 as B,a3 as F,a9 as W,a6 as V,a7 as Z}from"./createReactComponent-2m13N_Ce.js";var le="-",$="AMP",ue="".concat($,"_unsent"),O="https://api2.amplitude.com/2/httpapi",G="https://api.eu.amplitude.com/2/httpapi",Q="https://api2.amplitude.com/batch",z="https://api.eu.amplitude.com/batch",c;(function(t){t.Unknown="unknown",t.Skipped="skipped",t.Success="success",t.RateLimit="rate_limit",t.PayloadTooLarge="payload_too_large",t.Invalid="invalid",t.Failed="failed",t.Timeout="Timeout",t.SystemError="SystemError"})(c||(c={}));var fe=function(){var t="ampIntegrationContext";if(typeof globalThis<"u"&&typeof globalThis[t]<"u")return globalThis[t];if(typeof globalThis<"u")return globalThis;if(typeof window<"u")return window;if(typeof self<"u")return self;if(typeof global<"u")return global},de=function(t){return{promise:t||Promise.resolve()}},p;(function(t){t[t.None=0]="None",t[t.Error=1]="Error",t[t.Warn=2]="Warn",t[t.Verbose=3]="Verbose",t[t.Debug=4]="Debug"})(p||(p={}));var R="Amplitude Logger ",H=function(){function t(){this.logLevel=p.None}return t.prototype.disable=function(){this.logLevel=p.None},t.prototype.enable=function(e){e===void 0&&(e=p.Warn),this.logLevel=e},t.prototype.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.logLevel<p.Verbose||console.log("".concat(R,"[Log]: ").concat(e.join(" ")))},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.logLevel<p.Warn||console.warn("".concat(R,"[Warn]: ").concat(e.join(" ")))},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.logLevel<p.Error||console.error("".concat(R,"[Error]: ").concat(e.join(" ")))},t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this.logLevel<p.Debug||console.log("".concat(R,"[Debug]: ").concat(e.join(" ")))},t}(),L=function(){return{flushMaxRetries:12,flushQueueSize:200,flushIntervalMillis:1e4,instanceName:"$default_instance",logLevel:p.Warn,loggerProvider:new H,offline:!1,optOut:!1,serverUrl:O,serverZone:"US",useBatch:!1}},ce=function(){function t(e){var r,n,i,a;this._optOut=!1;var o=L();this.apiKey=e.apiKey,this.flushIntervalMillis=(r=e.flushIntervalMillis)!==null&&r!==void 0?r:o.flushIntervalMillis,this.flushMaxRetries=e.flushMaxRetries||o.flushMaxRetries,this.flushQueueSize=e.flushQueueSize||o.flushQueueSize,this.instanceName=e.instanceName||o.instanceName,this.loggerProvider=e.loggerProvider||o.loggerProvider,this.logLevel=(n=e.logLevel)!==null&&n!==void 0?n:o.logLevel,this.minIdLength=e.minIdLength,this.plan=e.plan,this.ingestionMetadata=e.ingestionMetadata,this.offline=e.offline!==void 0?e.offline:o.offline,this.optOut=(i=e.optOut)!==null&&i!==void 0?i:o.optOut,this.serverUrl=e.serverUrl,this.serverZone=e.serverZone||o.serverZone,this.storageProvider=e.storageProvider,this.transportProvider=e.transportProvider,this.useBatch=(a=e.useBatch)!==null&&a!==void 0?a:o.useBatch,this.loggerProvider.enable(this.logLevel);var s=K(e.serverUrl,e.serverZone,e.useBatch);this.serverZone=s.serverZone,this.serverUrl=s.serverUrl}return Object.defineProperty(t.prototype,"optOut",{get:function(){return this._optOut},set:function(e){this._optOut=e},enumerable:!1,configurable:!0}),t}(),X=function(t,e){return t==="EU"?e?z:G:e?Q:O},K=function(t,e,r){if(t===void 0&&(t=""),e===void 0&&(e=L().serverZone),r===void 0&&(r=L().useBatch),t)return{serverUrl:t,serverZone:void 0};var n=["US","EU"].includes(e)?e:L().serverZone;return{serverZone:n,serverUrl:X(n,r)}},ve=function(){function t(){this.sdk={metrics:{histogram:{}}}}return t.prototype.recordHistogram=function(e,r){this.sdk.metrics.histogram[e]=r},t}(),Y=function(){function t(){}return t.prototype.getApplicationContext=function(){return{versionName:this.versionName,language:j(),platform:"Web",os:void 0,deviceModel:void 0}},t}(),j=function(){return typeof navigator<"u"&&(navigator.languages&&navigator.languages[0]||navigator.language)||""},N=function(){function t(){this.queue=[]}return t.prototype.logEvent=function(e){this.receiver?this.receiver(e):this.queue.length<512&&this.queue.push(e)},t.prototype.setEventReceiver=function(e){this.receiver=e,this.queue.length>0&&(this.queue.forEach(function(r){e(r)}),this.queue=[])},t}(),P=function(){return P=Object.assign||function(e){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},P.apply(this,arguments)};function D(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,a=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}var S=function(t,e){var r,n,i=["string","number","boolean","undefined"],a=typeof t,o=typeof e;if(a!==o)return!1;try{for(var s=D(i),u=s.next();!u.done;u=s.next()){var d=u.value;if(d===a)return t===e}}catch(y){r={error:y}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}if(t==null&&e==null)return!0;if(t==null||e==null||t.length!==e.length)return!1;var l=Array.isArray(t),f=Array.isArray(e);if(l!==f)return!1;if(l&&f){for(var v=0;v<t.length;v++)if(!S(t[v],e[v]))return!1}else{var g=Object.keys(t).sort(),I=Object.keys(e).sort();if(!S(g,I))return!1;var b=!0;return Object.keys(t).forEach(function(y){S(t[y],e[y])||(b=!1)}),b}return!0},J="$set",ee="$unset",te="$clearAll";Object.entries||(Object.entries=function(t){for(var e=Object.keys(t),r=e.length,n=new Array(r);r--;)n[r]=[e[r],t[e[r]]];return n});var re=function(){function t(){this.identity={userProperties:{}},this.listeners=new Set}return t.prototype.editIdentity=function(){var e=this,r=P({},this.identity.userProperties),n=P(P({},this.identity),{userProperties:r});return{setUserId:function(i){return n.userId=i,this},setDeviceId:function(i){return n.deviceId=i,this},setUserProperties:function(i){return n.userProperties=i,this},setOptOut:function(i){return n.optOut=i,this},updateUserProperties:function(i){var a,o,s,u,d,l,f=n.userProperties||{};try{for(var v=D(Object.entries(i)),g=v.next();!g.done;g=v.next()){var I=M(g.value,2),b=I[0],y=I[1];switch(b){case J:try{for(var E=(s=void 0,D(Object.entries(y))),m=E.next();!m.done;m=E.next()){var T=M(m.value,2),U=T[0],C=T[1];f[U]=C}}catch(h){s={error:h}}finally{try{m&&!m.done&&(u=E.return)&&u.call(E)}finally{if(s)throw s.error}}break;case ee:try{for(var w=(d=void 0,D(Object.keys(y))),_=w.next();!_.done;_=w.next()){var U=_.value;delete f[U]}}catch(h){d={error:h}}finally{try{_&&!_.done&&(l=w.return)&&l.call(w)}finally{if(d)throw d.error}}break;case te:f={};break}}}catch(h){a={error:h}}finally{try{g&&!g.done&&(o=v.return)&&o.call(v)}finally{if(a)throw a.error}}return n.userProperties=f,this},commit:function(){return e.setIdentity(n),this}}},t.prototype.getIdentity=function(){return P({},this.identity)},t.prototype.setIdentity=function(e){var r=P({},this.identity);this.identity=P({},e),S(r,this.identity)||this.listeners.forEach(function(n){n(e)})},t.prototype.addIdentityListener=function(e){this.listeners.add(e)},t.prototype.removeIdentityListener=function(e){this.listeners.delete(e)},t}(),x=typeof globalThis<"u"?globalThis:typeof global<"u"?global:self,ne=function(){function t(){this.identityStore=new re,this.eventBridge=new N,this.applicationContextProvider=new Y}return t.getInstance=function(e){return x.analyticsConnectorInstances||(x.analyticsConnectorInstances={}),x.analyticsConnectorInstances[e]||(x.analyticsConnectorInstances[e]=new t),x.analyticsConnectorInstances[e]},t}(),q=function(t){return t===void 0&&(t="$default_instance"),ne.getInstance(t)},he=function(t,e){q(e).identityStore.editIdentity().setUserId(t).commit()},ge=function(t,e){q(e).identityStore.editIdentity().setDeviceId(t).commit()},ie=function(t){var e=new Error().stack||"";return e.split(`
`).slice(2+t).map(function(r){return r.trim()})},ye=function(t){return function(){var e=F({},t.config),r=e.loggerProvider,n=e.logLevel;return{logger:r,logLevel:n}}},ae=function(t,e){var r,n;e=e.replace(/\[(\w+)\]/g,".$1"),e=e.replace(/^\./,"");try{for(var i=B(e.split(".")),a=i.next();!a.done;a=i.next()){var o=a.value;if(o in t)t=t[o];else return}}catch(s){r={error:s}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return t},pe=function(t,e){return function(){var r,n,i={};try{for(var a=B(e),o=a.next();!o.done;o=a.next()){var s=o.value;i[s]=ae(t,s)}}catch(u){r={error:u}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return i}},me=function(t,e,r,n,i){return i===void 0&&(i=null),function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];var s=r(),u=s.logger,d=s.logLevel;if(d&&d<p.Debug||!d||!u)return t.apply(i,a);var l={type:"invoke public method",name:e,args:a,stacktrace:ie(1),time:{start:new Date().toISOString()},states:{}};n&&l.states&&(l.states.before=n());var f=t.apply(i,a);return f&&f.promise?f.promise.then(function(){n&&l.states&&(l.states.after=n()),l.time&&(l.time.end=new Date().toISOString()),u.debug(JSON.stringify(l,null,2))}):(n&&l.states&&(l.states.after=n()),l.time&&(l.time.end=new Date().toISOString()),u.debug(JSON.stringify(l,null,2))),f}},oe=function(){function t(){}return t.prototype.send=function(e,r){return Promise.resolve(null)},t.prototype.buildResponse=function(e){var r,n,i,a,o,s,u,d,l,f,v,g,I,b,y,E,m,T,U,C,w,_;if(typeof e!="object")return null;var h=e.code||0,A=this.buildStatus(h);switch(A){case c.Success:return{status:A,statusCode:h,body:{eventsIngested:(r=e.events_ingested)!==null&&r!==void 0?r:0,payloadSizeBytes:(n=e.payload_size_bytes)!==null&&n!==void 0?n:0,serverUploadTime:(i=e.server_upload_time)!==null&&i!==void 0?i:0}};case c.Invalid:return{status:A,statusCode:h,body:{error:(a=e.error)!==null&&a!==void 0?a:"",missingField:(o=e.missing_field)!==null&&o!==void 0?o:"",eventsWithInvalidFields:(s=e.events_with_invalid_fields)!==null&&s!==void 0?s:{},eventsWithMissingFields:(u=e.events_with_missing_fields)!==null&&u!==void 0?u:{},eventsWithInvalidIdLengths:(d=e.events_with_invalid_id_lengths)!==null&&d!==void 0?d:{},epsThreshold:(l=e.eps_threshold)!==null&&l!==void 0?l:0,exceededDailyQuotaDevices:(f=e.exceeded_daily_quota_devices)!==null&&f!==void 0?f:{},silencedDevices:(v=e.silenced_devices)!==null&&v!==void 0?v:[],silencedEvents:(g=e.silenced_events)!==null&&g!==void 0?g:[],throttledDevices:(I=e.throttled_devices)!==null&&I!==void 0?I:{},throttledEvents:(b=e.throttled_events)!==null&&b!==void 0?b:[]}};case c.PayloadTooLarge:return{status:A,statusCode:h,body:{error:(y=e.error)!==null&&y!==void 0?y:""}};case c.RateLimit:return{status:A,statusCode:h,body:{error:(E=e.error)!==null&&E!==void 0?E:"",epsThreshold:(m=e.eps_threshold)!==null&&m!==void 0?m:0,throttledDevices:(T=e.throttled_devices)!==null&&T!==void 0?T:{},throttledUsers:(U=e.throttled_users)!==null&&U!==void 0?U:{},exceededDailyQuotaDevices:(C=e.exceeded_daily_quota_devices)!==null&&C!==void 0?C:{},exceededDailyQuotaUsers:(w=e.exceeded_daily_quota_users)!==null&&w!==void 0?w:{},throttledEvents:(_=e.throttled_events)!==null&&_!==void 0?_:[]}};case c.Timeout:default:return{status:A,statusCode:h}}},t.prototype.buildStatus=function(e){return e>=200&&e<300?c.Success:e===429?c.RateLimit:e===413?c.PayloadTooLarge:e===408?c.Timeout:e>=400&&e<500?c.Invalid:e>=500?c.Failed:c.Unknown},t}(),_e=function(t){W(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.send=function(r,n){return V(this,void 0,void 0,function(){var i,a,o;return Z(this,function(s){switch(s.label){case 0:if(typeof fetch>"u")throw new Error("FetchTransport is not supported");return i={headers:{"Content-Type":"application/json",Accept:"*/*"},body:JSON.stringify(n),method:"POST"},[4,fetch(r,i)];case 1:return a=s.sent(),[4,a.text()];case 2:o=s.sent();try{return[2,this.buildResponse(JSON.parse(o))]}catch{return[2,this.buildResponse({code:a.status})]}return[2]}})})},e}(oe),k;(function(t){t.US="US",t.EU="EU",t.STAGING="STAGING"})(k||(k={}));export{$ as A,oe as B,ce as C,_e as F,H as L,ve as R,c as S,le as U,ue as a,q as b,K as c,p as d,ge as e,me as f,fe as g,pe as h,ye as i,k as j,de as r,he as s};
